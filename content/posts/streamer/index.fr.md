---
title: Streamer
description: üîé DFIR Windows 
slug: streamer
date: 2025-06-01 00:00:05+0000
tags: ["HackTheBox", "Sherlock", "Hard", "Windows", "Writeup"]
---

![](pictures/lab.png)

## Sc√©nario
> Simon Stark est un d√©veloppeur chez forela qui a r√©cemment pr√©vu de diffuser des sessions de programmation avec ses coll√®gues, ce qui lui a valu l'appr√©ciation du PDG et d'autres coll√®gues. Il a install√© sans le savoir un logiciel de streaming bien connu qu'il a trouv√© par le biais d'une recherche sur Google et qui √©tait l'une des principales URL promues par les publicit√©s de Google. Malheureusement, les choses ont mal tourn√© et un incident de s√©curit√© s'est produit. Analysez les artefacts tri√©s fournis pour d√©couvrir ce qui s'est pass√© exactement.


## Attack Flow Diagram - Sch√©ma global

Pour un rapide overview du challenge voici l'attack flow diagram que j'ai r√©alis√©, si vous ne voulez pas vous spoil vous pouvez le sauter :

![](pictures/attack-flow-diagram.png)


## Setup
Pour ce Sherlock nous allons utiliser : 
- Eric Zimmerman's Tools (Registry Explorer, EvtxECmd, MFTECmd TimeLine Explorer, PECmd...)
- HxD Hex Editor
- strings

Pour nous aider on va aussi s'appuyer sur des Cheatsheets tels que :
- https://cdn.13cubed.com/downloads/windows_event_log_cheat_sheet.pdf
- https://cdn.13cubed.com/downloads/windows_registry_cheat_sheet.pdf
- https://cdn.13cubed.com/downloads/anatomy_of_an_ntfs_file_record.pdf


## Question 1
> Quel est le nom original du fichier zip malveillant que l'utilisateur a t√©l√©charg√© en pensant qu'il s'agissait d'une copie l√©gitime du logiciel ?

Pour r√©pondre √† cette question nous allons chercher dans la hive utilisateur **NTUSER.DAT**. En effet, c'est ici que sont enregistr√©es, dans la cl√© *RecentDocs*, les fichiers r√©cemment ouverts par l‚Äôutilisateur.

![Recent Docs](pictures/RecentDocs.png)

**R√©ponse** : ``OBS-Studio-28.1.2-Full-Installer-x64.zip``

---
## Question 2
> Simon Stark a renomm√© le fichier zip t√©l√©charg√© en un autre nom. Quel est le nom renomm√© du fichier ainsi que le chemin d'acc√®s complet ?

Pour r√©pondre √† cette question, il faut d‚Äôabord comprendre que toute op√©ration de renommage sous NTFS (le filesystem de Windows) g√©n√®re une modification du **$FILE_NAME** *(attribut 0x30)* dans la MFT. 

On utilise donc **MFTECmd** pour parser la $MFT : 
```powershell
MFTECmd.exe -f "C:\$MFT" --csv "C:\Temp\Out"
```

Puis on l'importe dans **Timeline Explorer** :

![Recent Docs](pictures/Q2.png)

**R√©ponse** : ``C:\Users\Simon.stark\Documents\Streaming Software\Obs Streaming Software.zip``

---
## Question 3
> Quelle est l'heure √† laquelle le fichier a √©t√© renomm√© ?

Toujours au m√™me endroit :

![Recent Docs](pictures/Q3.png)

**R√©ponse** : ``2023-05-05 10:22:23``

---
## Question 4
> Quelle est l'URL compl√®te √† partir de laquelle le logiciel a √©t√© t√©l√©charg√© ?

Toujours au m√™me endroit : 

![Recent Docs](pictures/Q4.png)

Le fait de t√©l√©charger un fichier sous Windows (via un navigateur comme Edge ou Internet Explorer) cr√©e automatiquement, sur le NTFS, un flux de donn√©es auxiliaire nomm√© **Zone.Identifier**. 

Ce flux ADS (‚ÄúAlternate Data Stream‚Äù) est stock√© avec le fichier lui-m√™me et contient notamment :
- **ZoneId** : la zone de s√©curit√© (3 = internet)
- **ReferrerUrl** : l‚ÄôURL de la page qui a lanc√© le t√©l√©chargement
- **HostUrl** : l‚ÄôURL exacte du fichier t√©l√©charg√©

**R√©ponse** : ``http://obsproicet.net/download/v28_23/OBS-Studio-28.1.2-Full-Installer-x64.zip``

---
## Question 5
> Approfondissez vos recherches et trouvez l'adresse IP sur laquelle le domaine malveillant √©tait h√©berg√©.

Ici tr√®s simple, on parse avec **EvtxECmd** les event logs et on cherche le nom de domaine : 

```powershell
EvtxECmd.exe -d 'C:\Windows\System32\winevt\Logs\' --csv 'C:\Temp\out'
```

![Recent Docs](pictures/Q5.png)

**R√©ponse** : ``13.232.96.186``

---
## Question 6
> Plusieurs ports sources sont connect√©s pour communiquer et t√©l√©charger le fichier malveillant √† partir du site web malveillant. R√©pondez au num√©ro de port source le plus √©lev√© √† partir duquel la machine s'est connect√©e au site web malveillant.

Sur Windows si le pare-feu est configur√© pour logg√© les connexions, il va enregistrer chaque tentative d‚Äôacc√®s, non pas sous forme de nom de domaine, mais sous la forme de l‚ÄôIP cible.

Le fichier **pfirewall.log** (*C:\Windows\System32\LogFiles\Firewall*) enregistre, pour chaque paquet examin√© :
- la date et l‚Äôheure,
- l‚Äôaction (par exemple ‚ÄúALLOW‚Äù ou ‚ÄúDROP‚Äù),
- le protocole (TCP/UDP),
- l‚Äôadresse IP source,
- l‚Äôadresse IP de destination,
- les ports source et destination etc.

Ici seulement 6 connexions √† cette IP donc pas la peine de s'emb√™ter, on peut le trouver manuellement en 5 secondes :

![Recent Docs](pictures/pfirewall.png)

**R√©ponse** : ``50045``

---
## Question 7
> Le fichier zip contenait un fichier d'installation malveillant qui installait un logiciel malveillant et une instance l√©gitime du logiciel OBS studio, de sorte que l'utilisateur n'avait aucune id√©e qu'il avait √©t√© compromis. Trouvez le hachage du fichier d'installation.

Pour r√©pondre √† cette question on va chercher du c√¥t√© de la hive Amcache. Elle recense tous les ex√©cutables lorsqu‚Äôils sont lanc√©s, install√©s, copi√©s, etc. Elle stocke pour chaque application plusieurs metadata : chemin complet, date d‚Äôapparition, et notamment le **hash SHA1** du binaire.

Concr√®tement, au moment o√π l‚Äôutilisateur a extrait le zip et que le setup malveillant a √©t√© ex√©cut√© (ou m√™me simplement ouvert en soit), Windows a ajout√© une entr√©e dans la cl√© :

```r
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModel\InventoryApplicationFile
```
(correspondant √† Amcache\InventoryApplicationFile dans le hive Amcache.hve)

![Recent Docs](pictures/InventoryApplicationFile.png)

Si nous avions eu une copie du disque compl√®te, on aurait pu calculer le hash √† la vol√©e pour aller plus rapidement. N√©anmoins, c'est une mauvaise id√©e. 

Contrairement au simple hash calcul√© √† la vol√©e, **Amcache** enregistre le SHA1 d√®s la premi√®re ex√©cution ou extraction dans le syst√®me local, ind√©pendamment de toute modification ult√©rieure (√† moins que l‚Äôentr√©e Amcache soit explicitement √©dit√© / supprim√©).

M√™me si l‚Äôutilisateur a effac√© le zip ou renomm√© le setup, Amcache conserve cette ancienne trace tant que le fichier n‚Äôest pas r√©install√© ou que l‚Äôentr√©e n‚Äôest pas nettoy√©e.

**R√©ponse** : ``35e3582a9ed14f8a4bb81fd6aca3f0009c78a3a1``

---
## Question 8
> Le logiciel malveillant a install√© automatiquement une porte d√©rob√©e sur le poste de travail de la victime. Quels sont le nom et le chemin d'acc√®s au fichier de la porte d√©rob√©e ?

Retournons √† la **$MFT** car elle enregistre chaque cr√©ation et **ex√©cution** de fichier. 

Pour proc√©der j'ai simplement chercher un lien temporel avec l'ex√©cution du setup malveillant :
- je savais qu‚Äô√† l‚Äôinstant T0 (2023-05-05 10:23:14), l‚Äôutilisateur a lanc√© le setup malveillant
- quelques secondes plus tard (T0 + quelques secondes) appara√Æt dans la chronologie une nouvelle entr√©e : ``C:\Program Files\Miloyeki ker konoyogi\lat takewode libigax weloj jihi quimodo datex dob cijoyi mawiropo.exe``
- comme il n‚Äôexistait pas avant (aucune entr√©e ant√©rieure dans le **$MFT** pour ce chemin), on en d√©duit que c‚Äôest ce fichier qu‚Äôa cr√©√© le setup malveillant.

![Recent Docs](pictures/Q8.png)

**R√©ponse** : ``C:\Users\Simon.stark\Miloyeki ker konoyogi\lat takewode libigax weloj jihi quimodo datex dob cijoyi mawiropo.exe``

---
## Question 9
> Trouver le "prefetch hash" de la backdoor.

Lorsque qu'on ex√©cute un programme sous Windows, le syst√®me enregistre un fichier *.pf* (prefetch) dans **C:\Windows\Prefetch** dont le nom combine :
1. Le nom de l‚Äôex√©cutable (`LAT TAKEWODE‚Ä¶.exe`)
2. Un hash calcul√© √† partir de son chemin complet sur le disque

Ce hash n‚Äôest pas al√©atoire, Windows le g√©n√®re pour distinguer plusieurs instances du m√™me ex√©cutable si elles r√©sident √† des chemins diff√©rents.

```powershell
.\PECmd.exe -d 'C:\Windows\prefetch' --csv 'C:\Temp\Out'
```

![Recent Docs](pictures/Q9.png)

**R√©ponse** : ``D8A6D943``

---
## Question 10
> La backdoor est √©galement utilis√©e comme m√©canisme de persistance de mani√®re furtive pour se fondre dans l'environnement. Quel est le nom utilis√© pour le m√©canisme de persistance afin qu'il ait l'air l√©gal ?

Les m√©canismes de persistance les plus couramment mis en oeuvre sont : 
- Cl√©s de registre Run / RunOnce
- Service Windows
- T√¢ches planifi√©es
- Dossier de d√©marrage (dossier Startup) etc.

Ici, il repose sur la cr√©ation d‚Äôune t√¢che planifi√©e dont le nom imite un processus syst√®me **COMSurrogate**. Quand Windows cr√©e ou modifie une t√¢che planifi√©e, un √©v√©nement **ID 4698** (‚ÄúA scheduled task was created‚Äù) est enregistr√© dans le journal de s√©curit√© (**Security.evtx**).

```powershell
 .\EvtxECmd.exe -d 'C:\Windows\System32\winevt\Logs\' --csv 'C:\Temp\Out\'
```

![Recent Docs](pictures/EventID.png)

![Recent Docs](pictures/TaskName.png)

```xml
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <RegistrationInfo>
    <Date>2023-05-05T15:23:21</Date>
    <Author>FORELA\simon.stark</Author>
    <URI>\COMSurrogate</URI>
  </RegistrationInfo>
  <Triggers>
    <LogonTrigger>
      <StartBoundary>2023-05-05T15:23:00</StartBoundary>
      <Enabled>true</Enabled>
    </LogonTrigger>
  </Triggers>
  <Principals>
    <Principal id="Author">
      <RunLevel>HighestAvailable</RunLevel>
      <UserId>FORELA\simon.stark</UserId>
      <LogonType>InteractiveToken</LogonType>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <Duration>PT10M</Duration>
      <WaitTimeout>PT1H</WaitTimeout>
      <StopOnIdleEnd>true</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>PT72H</ExecutionTimeLimit>
    <Priority>7</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>C:\Users\Simon.stark\Miloyeki</Command>
      <Arguments>ker konoyogi\lat takewode libigax weloj jihi quimodo datex dob cijoyi mawiropo.exe</Arguments>
    </Exec>
  </Actions>
</Task>
```

**R√©ponse** : ``COMSurrogate``

---
## Question 11
> Quel est le domaine erron√©/invalide nomm√© de mani√®re al√©atoire que le logiciel malveillant a tent√© d'atteindre ?

Puisque la t√¢che planifi√©e a √©t√© cr√©√©e √† 10:23:21, on se place autour de cet horaire dans le channel **Microsoft-Windows-DNS-Client/Operational** pour rep√©rer le domaine "invalide" que le malware a tent√© de r√©soudre.

![Recent Docs](pictures/invalid-domain.png)

**R√©ponse** : ``oaueeewy3pdy31g3kpqorpc4e.qopgwwytep``

---
## Question 12
> Le logiciel malveillant a essay√© d'exfiltrer les donn√©es vers un seau s3. Quelle est l'url du seau s3 ?

Idem mais on filtre avec "s3" :

![Recent Docs](pictures/s3.png)

**R√©ponse** : ``bbuseruploads.s3.amazonaws.com``

---
## Question 13
> Sur quel sujet Simon allait-il faire un stream en semaine 1 ? Trouvez une note ou quelque chose de similaire et r√©cup√©rez son contenu pour r√©pondre √† la question.

On retrouve dans les fichiers r√©cents de l'utilisateur un shortcut vers le fichier "Week 1 plan.txt". Mais aucune trace du fichier car on n'a pas la copie du dossier en question. 

![Recent Docs](pictures/recent.png)

On va donc analyser la **$MFT**. Comme on l'a d√©j√† vu, chaque fichier m√™me s'il a √©t√© effac√© ou d√©plac√© poss√®de une entr√©e dans la MFT et on va pouvoir retrouver la "resident data" :

![Recent Docs](pictures/MFT.png)

- **Non-resident** : pour les fichiers de taille suffisante, NTFS ne stocke pas directement leurs donn√©es dans la MFT. Le champ `$DATA` contient alors des ‚Äúruns‚Äù (des blocs) qui pointent vers des clusters sur le disque o√π le contenu r√©el est stock√©.
- **Resident** : quand que le fichier est tr√®s petit (historiquement : moins de 1 KB ou de l‚Äôordre de quelques centaines d‚Äôoctets, selon la version de Windows et la taille de l‚Äôattribut), ses donn√©es sont stock√©es **directement √† l‚Äôint√©rieur m√™me de l‚Äôentr√©e MFT**, dans le bloc `$DATA`. On parle alors de **resident data**.

```r
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MFT Header    ‚îÇ Attribut #0  (STANDARD_INFO)    ‚îÇ  ...                ‚îÇ
‚îÇ (48 bytes‚Ä¶)   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                     ‚îÇ
‚îÇ               ‚îÇ Attribut #1  (FILE_NAME)‚îÇ       ‚îÇ                     ‚îÇ
‚îÇ               ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                     ‚îÇ
‚îÇ               ‚îÇ Attribut #2  (DATA, resident)   ‚îÇ <‚Äî c‚Äôest l√† qu‚Äôest  ‚îÇ
‚îÇ               ‚îÇ                                 ‚îÇ    stock√© le texte. ‚îÇ
‚îÇ               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ	......                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

cf. https://youtu.be/B4b6Ocf3wYs?si=rUruujZiEIdjgFKD 

![Recent Docs](pictures/hxd.png)

**R√©ponse** : ``Filesystem Security``

---
## Question 14
> Quel est le nom de l'analyste de s√©curit√© qui a tri√© le poste de travail infect√© ?

Un peu de guess car la question n'est pas tr√®s int√©ressante, si vous avez fait pas mal de Sherlock vous commencez √† avoir l'habitude c'est CyberJunkie. 

![Recent Docs](pictures/users.png)

**R√©ponse** : ``CyberJunkie``

---
## Question 15
> Quel est le chemin d'acc√®s au r√©seau √† partir duquel les outils d'acquisition ont √©t√© ex√©cut√©s ?

Premi√®rement nous devons trouver le tool utilis√©. Pour cela, plusieurs m√©thodes : 
- v√©rifier les fichiers LNK & Jump Lists
- Event ID 4688 (A new process has been created)
- AmCache (InventoryApplicationFile)
- $MFT comme on l'a vu plus t√¥t
- Les fichiers Prefetch

Pour le plus de rapidit√© j'ai d√©cid√© de passer via les fichiers prefetch. Logiquement le tool d'acquisition a √©t√© lanc√© le plus r√©cemment possible : 

![Recent Docs](pictures/prefetch.png)

N√©anmoins pas de chemin.

Du coup, je v√©rifie dans : 
- AppCompatCache : RAS
- Event ID 4688 : RAS
- $MFT : RAS

Je vais donc chercher du c√¥t√© du NTUSER.DAT mais RAS aussi... N√©anmoins on voit bien qu'on a **ntuser.dat.LOG1** et **LOG2**.

Ce sont des journaux de transactions associ√© √† la ruche de registre utilisateur (**NTUSER.DAT**). 

Chaque modification apport√©e aux cl√©s et valeurs du registre (par exemple, lorsqu‚Äôun chemin r√©seau est ajout√© dans un MRU ou un cl√© UserAssist) est d‚Äôabord √©crite dans ce journal avant d‚Äô√™tre int√©gr√©e (‚Äúcommitt√©e") dans **NTUSER.DAT** lui-m√™me. Concr√®tement :
- c‚Äôest le log transactionnel de la ruche utilisateur : √† chaque fois qu‚Äôune application ou Windows √©crit quelque chose dans HKCU (RunMRU, UserAssist, RecentDocs, etc.), la modification est d‚Äôabord consign√©es dans NTUSER.DAT.LOG1 (et LOG2), puis fusionn√©e dans NTUSER.DAT √† un checkpoint
- si on ferme brutalement la session ou qu‚Äôaucun ‚Äúcheckpoint‚Äù n‚Äôa encore eu lieu, NTUSER.DAT.LOG1 peut contenir des entr√©es qui n‚Äôapparaissent pas encore dans NTUSER.DAT

Je lance donc une recherche via string et bingo : 

![Recent Docs](pictures/strings.png)

**R√©ponse** : ``\\DESKTOP-887GK2L\Users\CyberJunkie\Desktop\Forela-Triage-Workstation\Acquisiton and Triage tools``

---

## IOC Table

| Cat√©gorie              | Type / Champ        | Valeur (indicateur)                                                                                                | Notes                              | Hash                                                 |
| ---------------------- | ------------------- | ------------------------------------------------------------------------------------------------------------------ | ---------------------------------- | ---------------------------------------------------- |
| **Fichiers (origine)** | Nom ZIP original    | `OBS-Studio-28.1.2-Full-Installer-x64.zip`                                                                         | NTUSER.DAT ‚ñ∏ RecentDocs            | RAS (pas le fichier)                                 |
|                        | Setup malveillant   | `OBS Studio 28.1.2 Full Installer x64.exe`                                                                         | Amcache ‚ñ∏ InventoryApplicationFile | **SHA-1 = 35e3582a9ed14f8a4bb81fd6aca3f0009c78a3a1** |
|                        | Backdoor EXE        | `C:\Users\Simon.stark\Miloyeki ker konoyogi\lat takewode libigax weloj jihi quimodo datex dob cijoyi mawiropo.exe` | $MFT                               | RAS (pas le fichier)                                 |
| **R√©seau**             | Domain              | `obsproicet.net`                                                                                                   | ADS Zone.Identifier                |                                                      |
|                        | URL exacte          | `http://obsproicet.net/download/v28_23/OBS-Studio-28.1.2-Full-Installer-x64.zip`                                   | ADS Zone.Identifier                |                                                      |
|                        | IP serveur          | `13.232.96.186`                                                                                                    | pfirewall.log                      |                                                      |
|                        | Port source max     | `50045` (TCP)                                                                                                      | pfirewall.log                      |                                                      |
|                        | Domain invalide     | `oaueeewy3pdy31g3kpqorpc4e.qopgwwytep`                                                                             | DNS-Client Operational             |                                                      |
|                        | Bucket S3 exfil     | `bbuseruploads.s3.amazonaws.com`                                                                                   | DNS-Client Operational             |                                                      |
| **Persistance**        | Scheduled Task Name | `\COMSurrogate`                                                                                                    | Security.evtx (4698)               |                                                      |
|                        | Prefetch hash       | `D8A6D943`                                                                                                         | Nom du .pf                         |                                                      |

---

Lab termin√© ! 

![](pictures/finished.png)

https://labs.hackthebox.com/achievement/sherlock/1271052/899