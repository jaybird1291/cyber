<!doctype html><html lang=ja dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="ja"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>APTNightmare-2 &#183; Jaybird1291</title>
<meta name=title content="APTNightmare-2 &#183; Jaybird1291"><meta name=description content="🔎 Linux Memory Forensic"><meta name=keywords content="HackTheBox,Sherlock,Hard,Linux,Writeup,"><link rel=canonical href=https://jaybird1291.github.io/cyber/ja/posts/aptnightmare2/><link type=text/css rel=stylesheet href=/cyber/css/main.bundle.min.21c05b9715cc67cd8544490094919a0e16124deb8f6dce3d6fc5b571825a9c5675ccc37209fe1b6d08eeaa9292a2bdee911a6356c7239a0df0835b5ef1397de9.css integrity="sha512-IcBblxXMZ82FREkAlJGaDhYSTeuPbc49b8W1cYJanFZ1zMNyCf4bbQjuqpKSor3ukRpjVscjmg3wg1te8Tl96Q=="><script type=text/javascript src=/cyber/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/cyber/js/main.bundle.min.65b5de43825ad54a420102c9ddccece1f1015665fe76e5b399ba259e1de29f6c83ac1b3cf77beed3d29e26604dfebf561a8e1db523cb6add0d6acccc9e8f1307.js integrity="sha512-ZbXeQ4Ja1UpCAQLJ3czs4fEBVmX+duWzmbolnh3in2yDrBs893vu09KeJmBN/r9WGo4dtSPLat0NaszMno8TBw==" data-copy data-copied></script><script src=/cyber/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ=="></script><link rel=icon href=/cyber/favicon.ico><meta property="og:url" content="https://jaybird1291.github.io/cyber/ja/posts/aptnightmare2/"><meta property="og:site_name" content="Jaybird1291"><meta property="og:title" content="APTNightmare-2"><meta property="og:description" content="🔎 Linux Memory Forensic"><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-20T00:00:05+00:00"><meta property="article:modified_time" content="2025-04-20T00:00:05+00:00"><meta property="article:tag" content="HackTheBox"><meta property="article:tag" content="Sherlock"><meta property="article:tag" content="Hard"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Writeup"><meta property="og:image" content="https://jaybird1291.github.io/cyber/posts/aptnightmare2/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaybird1291.github.io/cyber/posts/aptnightmare2/featured.png"><meta name=twitter:title content="APTNightmare-2"><meta name=twitter:description content="🔎 Linux Memory Forensic"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"APTNightmare-2","headline":"APTNightmare-2","description":"🔎 Linux Memory Forensic","abstract":"シナリオ # サーバー復旧後、IRチームは継続するトラフィック、隠された通信、および終了措置を回避する執拗なプロセスの迷宮を発見しました。ンシデントの範囲はサーバーとクライアントへの最初の侵害を超えていることが明らかです。フォレンジック調査の専門家として、これらの秘密裏の活動を隠す影を照らし出すことはできますか？","inLanguage":"ja","url":"https:\/\/jaybird1291.github.io\/cyber\/ja\/posts\/aptnightmare2\/","author":{"@type":"Person","name":"Jaybird1291"},"copyrightYear":"2025","dateCreated":"2025-04-20T00:00:05\u002b00:00","datePublished":"2025-04-20T00:00:05\u002b00:00","dateModified":"2025-04-20T00:00:05\u002b00:00","keywords":["HackTheBox","Sherlock","Hard","Linux","Writeup"],"mainEntityOfPage":"true","wordCount":"460"}]</script><meta name=author content="Jaybird1291"><link href=https://app.hackthebox.com/profile/1271052 rel=me><link href=https://cyberdefenders.org/p/Jaybird1291#/overview rel=me><link href=https://www.root-me.org/Jaybird1291 rel=me><link href=https://tryhackme.com/p/Jaybird1291 rel=me><link href=https://discordlookup.com/user/168778579281182721 rel=me><link href=mailto:jaybird1291.wcjg1@8alias.com rel=me><link href=https://jaybird1291.github.io/japanese/ rel=me><script src=/cyber/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><meta name=theme-color><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js></script><script>const firebaseConfig={apiKey:"AIzaSyDujZmq6LcevuHNyqL0wAr6PRQ5I4ghrq8",authDomain:"AIzaSyDujZmq6LcevuHNyqL0wAr6PRQ5I4ghrq8",projectId:"blog-489bb",storageBucket:"blog-489bb.firebasestorage.app",messagingSenderId:"371792650664",appId:"1:371792650664:web:795088b1fcc1d8e353fd9d",measurementId:"G-GSCW16N4H9"};var app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth()</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>メインコンテンツへスキップ</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3"><div><a href=/cyber/ja/ class=flex><span class=sr-only>Jaybird1291</span>
<img src=/cyber/img/avatar.png width=64 height=64 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=Jaybird1291></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/cyber/ja/ class="text-base font-medium text-gray-500 hover:text-gray-900">Jaybird1291</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/cyber/ja/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M421.7 220.3 188.5 453.4l-33.9-33.9 3.5-3.5H112C103.2 416 96 408.8 96 4e2V353.9l-3.49 3.5C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6l78.16-23C143.1 427.7 149.8 424.2 154.6 419.5l33.9 33.9c-10.4 10.4-23.3 18.1-37.4 22.2L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1.8198 498.8-1.502 489.7.976 481.2L36.37 360.9c4.16-14.1 11.79-27 22.2-37.4L291.7 90.34l130 129.96zm71-161.55C517.7 83.74 517.7 124.3 492.7 149.3l-48.4 48.4-130-129.98 48.4-48.4c25-24.998 65.6-24.998 90.6.0l39.4 39.43z"/></svg></span></span><p class="text-base font-medium" title>ポスト</p></a><a href=/cyber/ja/posts/portfolio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M320 32c-8.1.0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9.0 149.9.0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9V320c0 28.4-10.8 57.7-22.3 80.8-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3.9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7.3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7-3.2-14.2-7.5-28.7-13.5-42V291.9c0-30.2 10.2-58.7 27.9-81.5 12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5.8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1l280.6-101c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg></span></span><p class="text-base font-medium" title>ポートフォリオ</p></a><a href=/cyber/ja/posts/projets/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M80 104c13.3.0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24zm80-24c0 32.8-19.7 61-48 73.3V192c0 17.7 14.3 32 32 32H304c17.7.0 32-14.3 32-32V153.3C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V192c0 53-43 96-96 96H256v70.7c28.3 12.3 48 40.5 48 73.3.0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V288H144c-53 0-96-43-96-96V153.3C19.7 141 0 112.8.0 80 0 35.8 35.8.0 80 0s80 35.8 80 80zm208 24c13.3.0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24zM248 432c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24z"/></svg></span></span><p class="text-base font-medium" title>プロジェクト</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>JA</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/cyber/en/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>EN</p></a><a href=/cyber/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>FR</p></a><a href=/cyber/ja/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>JA</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span><div><div class="cursor-pointer flex items-center nested-menu"><span class="ltr:mr-1 rtl:ml-1"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>JA</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/cyber/en/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>EN</p></a><a href=/cyber/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>FR</p></a><a href=/cyber/ja/posts/aptnightmare2/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title=APTNightmare-2>JA</p></a></div></div></div></div><button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></div></div><div class="-my-2 md:hidden"><label id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/cyber/ja/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M421.7 220.3 188.5 453.4l-33.9-33.9 3.5-3.5H112C103.2 416 96 408.8 96 4e2V353.9l-3.49 3.5C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6l78.16-23C143.1 427.7 149.8 424.2 154.6 419.5l33.9 33.9c-10.4 10.4-23.3 18.1-37.4 22.2L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1.8198 498.8-1.502 489.7.976 481.2L36.37 360.9c4.16-14.1 11.79-27 22.2-37.4L291.7 90.34l130 129.96zm71-161.55C517.7 83.74 517.7 124.3 492.7 149.3l-48.4 48.4-130-129.98 48.4-48.4c25-24.998 65.6-24.998 90.6.0l39.4 39.43z"/></svg></span></div><p class="text-bg font-bg" title>ポスト</p></a></li><li class=mt-1><a href=/cyber/ja/posts/portfolio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M320 32c-8.1.0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9.0 149.9.0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9V320c0 28.4-10.8 57.7-22.3 80.8-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3.9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7.3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7-3.2-14.2-7.5-28.7-13.5-42V291.9c0-30.2 10.2-58.7 27.9-81.5 12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5.8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1l280.6-101c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg></span></div><p class="text-bg font-bg" title>ポートフォリオ</p></a></li><li class=mt-1><a href=/cyber/ja/posts/projets/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M80 104c13.3.0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24zm80-24c0 32.8-19.7 61-48 73.3V192c0 17.7 14.3 32 32 32H304c17.7.0 32-14.3 32-32V153.3C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V192c0 53-43 96-96 96H256v70.7c28.3 12.3 48 40.5 48 73.3.0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V288H144c-53 0-96-43-96-96V153.3C19.7 141 0 112.8.0 80 0 35.8 35.8.0 80 0s80 35.8 80 80zm208 24c13.3.0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24zM248 432c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24z"/></svg></span></div><p class="text-bg font-bg" title>プロジェクト</p></a></li></ul></div></label></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">APTNightmare-2</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-04-20T00:00:05+00:00>20 4月 2025</time><span class="px-2 text-primary-500">&#183;</span><span title=読むのに必要な時間>3 分</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/aptnightmare-2/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/aptnightmare-2/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<button id=button_likes class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400" onclick=process_article()>
<span id=button_likes_heart style=display:none class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
</span></span><span id=button_likes_emtpty_heart class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M244 84l11.1 12 12-11.98C300.6 51.37 347 36.51 392.6 44.1 461.5 55.58 512 115.2 512 185.1V190.9c0 41.5-17.2 81.2-47.6 109.5L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9S235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1.0 232.4.0 190.9V185.1c0-69.9 50.52-129.52 119.4-141 44.7-7.59 92 7.27 124.6 39.9C243.1 84 244 84.01 244 84zm11.1 79.9-45-46.8c-21.7-20.82-52.5-30.7-82.8-25.66C81.55 99.07 48 138.7 48 185.1V190.9c0 28.2 11.71 55.2 32.34 74.4L256 429.3l175.7-164c20.6-19.2 32.3-46.2 32.3-74.4V185.1c0-46.4-33.6-86.03-79.3-93.66C354.4 86.4 323.6 96.28 301.9 117.1l-46.8 46.8z"/></svg>
</span></span><span id=button_likes_text>&nbsp;Like</span>
</button>
</span><span class="px-2 text-primary-500">&#183;</span>
<script type=text/javascript src=/cyber/js/zen-mode.min.eea5245cf9244ecbdf2c150d1c8833226c1541cadf6e98f63a7c9192b1a3676df2c3ec603b14f4cfaaa53971fd9d8955640c0f405bf3de2b43ee7a5fb29ae721.js integrity="sha512-7qUkXPkkTsvfLBUNHIgzImwVQcrfbpj2OnyRkrGjZ23yw+xgOxT0z6qlOXH9nYlVZAwPQFvz3itD7npfsprnIQ=="></script><span class=mb-[2px]><span id=zen-mode-button class="text-lg hover:text-primary-500" title=Zenモードを有効にする data-title-i18n-disable=Zenモードを有効にする data-title-i18n-enable=Zenモードを無効にする><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50" height="50"><path fill="currentcolor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/cyber/ja/tags/hackthebox/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">HackTheBox
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/cyber/ja/tags/sherlock/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Sherlock
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/cyber/ja/tags/hard/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hard
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/cyber/ja/tags/linux/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Linux
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/cyber/ja/tags/writeup/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Writeup</span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=Jaybird1291 src=/cyber/img/avatar_hud2bf25dca907ed534e4c2a509983967d_23908_192x192_fill_box_center_3.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">著者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Jaybird1291</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://app.hackthebox.com/profile/1271052 target=_blank aria-label=Htb rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="silver" d="M11.996.0a1.119 1.119.0 00-.057.003.9.9.0 00-.236.05.907.907.0 00-.165.079L1.936 5.675a.889.889.0 00-.445.77v11.111a.889.889.0 00.47.784l9.598 5.541.054.029v.002a.857.857.0 00.083.035l.012.004c.028.01.056.018.085.024.01.001.011.003.016.004a.93.93.0 00.296.015.683.683.0 00.086-.015c.01.0.011-.002.016-.004a.94.94.0 00.085-.024l.012-.004a.882.882.0 00.083-.035v-.002a1.086 1.086.0 00.054-.029l9.599-5.541a.889.889.0 00.469-.784V6.48l-.001-.026v-.008a.889.889.0 00-.312-.676l-.029-.024c0-.002-.01-.005-.01-.007a.899.899.0 00-.107-.07L12.453.127A.887.887.0 0011.99.0zm.01 2.253c.072.0.144.019.209.056l6.537 3.774a.418.418.0 010 .724l-6.537 3.774a.418.418.0 01-.418.0L5.26 6.807a.418.418.0 010-.724l6.537-3.774a.42.42.0 01.209-.056zm-8.08 6.458a.414.414.0 01.215.057l6.524 3.766a.417.417.0 01.208.361v7.533a.417.417.0 01-.626.361l-6.523-3.766a.417.417.0 01-.209-.362V9.13c0-.241.196-.414.41-.418zm16.16.0c.215.004.41.177.41.418v7.532a.42.42.0 01-.208.362l-6.524 3.766a.417.417.0 01-.626-.361v-7.533c0-.149.08-.286.209-.36l6.523-3.767a.415.415.0 01.216-.057z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://cyberdefenders.org/p/Jaybird1291#/overview target=_blank aria-label=Cyberdefenders rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24"><path fill="silver" d="M18.918 17.48c-.126 2.727-2.384 4.696-5.364 4.696H7.34v-6.123l-2.185-.957V24h8.381c4.334.0 7.549-2.962 7.549-6.881v-.163c-.65.235-1.372.415-2.167.524zm1.355-9.501C18.611 4.313 17.726.989 15.432.213c-1.336-.452-2.005-.091-2.637.217a.306.306.0 00-.072.505c.361.307.813.687 1.336 1.174-1.95-1.138-7.333-2.835-7.874-.776-.488 1.86-1.319 4.587-1.319 4.587S.603 5.487.116 7.293c-.488 1.806 3.323 5.274 9.627 7.134 6.303 1.861 11.198 1.373 13.311-.921 2.113-2.294.072-5.473-2.781-5.527zm-1.247.036c-.487.47-2.077 1.68-5.563 1.427-3.738-.271-6.809-2.474-7.604-3.088a.337.337.0 01-.126-.398c.054-.18.126-.469.253-.849.072-.234.343-.343.542-.216 1.571.903 4.1 2.221 6.791 2.402 2.402.163 3.847-.542 4.786-1.066a.389.389.0 01.542.199l.47 1.156c.036.162.018.325-.091.433z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.root-me.org/Jaybird1291 target=_blank aria-label=Rootme rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24"><path fill="silver" d="M21.364 9.897c0-.448-.029-.896-.096-1.325.0-.028-.009-.057-.009-.086-.582-3.785-3.452-6.894-7.228-7.723a.96.96.0 10-1.144 1.144v3.519c0 .057.028.114.076.152a.195.195.0 00.105.029c.019.0.048.0.067-.01l1.411-.534a.701.701.0 00.41.286v1.659c-.715.878-1.602 1.669-2.546 2.375l-1.077-2.499a.728.728.0 00.333-.61.734.734.0 10-.734.734h.038l1.125 2.603c-.658.477-1.335.906-2.002 1.297l-3.204-.963a.162.162.0 00-.114.01l-.954.372a.734.734.0 10.143.438c0-.028-.009-.057-.009-.086l.896-.352 2.794.839a33.46 33.46.0 01-4.873 2.231l-.171.057a.92.92.0 00-.553-.181h-.029a8.663 8.663.0 01-.677-3.366c0-.572.057-1.135.162-1.678H7.69a.726.726.0 00.706.543.734.734.0 000-1.468.727.727.0 00-.706.543h-4.1c.772-3.137 3.251-5.644 6.455-6.388a.976.976.0 00.82.467c.534.0.963-.429.963-.963S11.399.0 10.865.0a.973.973.0 00-.944.763c-4.205.953-7.285 4.739-7.285 9.125a9.33 9.33.0 00.735 3.642.967.967.0 00.372 1.602v3.757c0 .067.019.134.057.191l.21.143 2.851 2.012v2.403c0 .2.162.362.362.362h9.535c.2.0.362-.162.362-.362v-2.403l2.861-2.012.21-.153a.344.344.0 00.057-.19v-3.786a.958.958.0 00.353-1.535 9.038 9.038.0 00.763-3.662zm-1.383 3.366h-.086a.96.96.0 00-.334 1.86v3.509l-3.003 2.117a.363.363.0 00-.153.295v2.022a.211.211.0 01-.21.209H15.08a.211.211.0 01-.21-.209v-.725c0-.191-.133-.362-.324-.382a.367.367.0 00-.401.363v.753c0 .115-.095.21-.209.21h-1.364a.212.212.0 01-.21-.21v-1.116c0-.19-.133-.362-.324-.381a.366.366.0 00-.4.362v1.145a.212.212.0 01-.21.209h-1.364a.21.21.0 01-.209-.209v-.744c0-.191-.134-.362-.325-.382a.366.366.0 00-.4.363v.753c0 .115-.095.21-.21.21H7.805a.211.211.0 01-.21-.21v-2.021a.365.365.0 00-.153-.296l-2.994-2.117v-3.547a.96.96.0 00.563-.877c0-.057-.01-.114-.019-.172.381-.133 3.289-1.173 6.15-2.956 3.871-2.412 6.017-5.149 6.264-7.961a8.738 8.738.0 013.157 5.473c-.048 4.777-8.372 7.723-8.458 7.752-.019.009-.067.019-.105.038-.105-.019-.21-.038-.324-.057-.076-.019-.162-.029-.239-.048-.124-.019-.247-.048-.371-.076-.02-.01-.048-.01-.067-.01l-.143-.028c-.057-.01-.115-.029-.172-.039a4.559 4.559.0 01-.391-.095c-.238-.057-.467-.124-.696-.181-.219-.067-.448-.124-.658-.191H8.92a6.38 6.38.0 01-.467-.152 1 1 0 00-.153-.048c-.076-.029-.143-.048-.209-.067a2.812 2.812.0 01-.344-.124h-.009a5.979 5.979.0 01-.458-.171c-.143-.058-.267-.105-.362-.143-.096-.048-.181-.077-.229-.105-.057-.029-.086-.038-.086-.038s.019.028.057.066c.038.048.096.115.181.191.077.076.182.172.306.267.124.095.267.2.419.305h.01a2.126 2.126.0 00-.096.61c0 1.097.897 1.993 1.993 1.993.849.0 1.573-.534 1.86-1.287l.295.029c.172.009.334.009.486.009.01.0.019.01.029.01l1.611 1.64c.41.41 1.049.477 1.526.162l2.517-1.411a.793.793.0 00.363-.658v-2.899c.972-.772 1.85-1.688 2.422-2.727a8.13 8.13.0 01-.601 2.145zm-7.799 5.87-.002-.002c-.002-.002-.004-.003-.008-.003a.044.044.0 00-.013-.009l-.003-.002a.028.028.0 01-.013-.009c-.01.0-.019-.009-.029-.009-.009.0-.019-.01-.019-.01-.009.0-.019.0-.028-.009h-.115c-.009.0-.019.0-.028.009-.01.0-.019.01-.019.01-.01.0-.019.009-.029.009-.009.0-.019.01-.029.02-.009.0-.009.009-.019.009l-.038.038-.772.963a.276.276.0 00.219.448.285.285.0 00.219-.104l.01-.01a.7.7.0 011.097.0l.009.01a.287.287.0 00.391.047.277.277.0 00.048-.391l-.782-.953c-.01-.01-.019-.019-.019-.029l-.019-.019a.013.013.0 01-.009-.004zm-1.622-2.265c-.038.076-.095.152-.143.219a1.256 1.256.0 01-1.907.0 1.225 1.225.0 01-.295-.81c0-.077.009-.144.019-.22.152.076.314.153.476.229.22.095.449.191.687.267a8.884 8.884.0 001.163.315zm-6.503-2.184a.507.507.0 01-.305-.114.449.449.0 01-.133-.506.466.466.0 01.429-.295c.085.0.162.028.229.067a.464.464.0 01.228.4.46.46.0 01-.066.229.416.416.0 01-.382.219zm16.21-.181a.48.48.0 01-.362.181.467.467.0 01-.334-.143.467.467.0 01-.124-.315c0-.2.124-.371.305-.429a.448.448.0 01.162-.028.48.48.0 01.458.372.307.307.0 01.009.095.67.67.0 01-.114.267zm-5.845-9.869c0 .029.009.048.009.067l-1.163.438V1.897a.922.922.0 00.658-.457 8.472 8.472.0 012.823 1.201c-.01 1.411-.554 2.708-1.412 3.881V5.34a.728.728.0 00.544-.706c0-.4-.324-.734-.734-.734a.738.738.0 00-.725.734zm-3.48-1.735a.734.734.0 00-.735.696l-1.458.534a.193.193.0 00-.134.181v.925H7.442a.727.727.0 00-.705-.544.735.735.0 100 1.469.727.727.0 00.705-.544h1.364a.19.19.0 00.19-.19v-.983l1.288-.476c.124.238.372.4.648.4a.734.734.0 00.734-.734.725.725.0 00-.724-.734zm-.41-2.241a.46.46.0 01.343-.153.468.468.0 11-.258.859.475.475.0 01-.209-.382.45.45.0 01.124-.324zm2.097.305a.467.467.0 01.801-.324.462.462.0 01-.076.696.427.427.0 01-.267.086.452.452.0 01-.458-.458z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://tryhackme.com/p/Jaybird1291 target=_blank aria-label=Thm rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24"><path fill="silver" d="M10.705.0C7.54.0 4.902 2.285 4.349 5.291a4.525 4.525.0 00-4.107 4.5 4.525 4.525.0 004.52 4.52h6.761a.625.625.0 100-1.25H4.761a3.273 3.273.0 01-3.27-3.27A3.273 3.273.0 016.59 7.08a.625.625.0 00.7-1.035 4.488 4.488.0 00-1.68-.69 5.223 5.223.0 015.096-4.104 5.221 5.221.0 015.174 4.57 4.489 4.489.0 00-.488.305.625.625.0 10.731 1.013 3.245 3.245.0 011.912-.616 3.278 3.278.0 013.203 2.61.625.625.0 001.225-.251 4.533 4.533.0 00-4.428-3.61 4.54 4.54.0 00-.958.105C16.556 2.328 13.9.0 10.705.0zm5.192 10.64a.925.925.0 00-.462.108.913.913.0 00-.313.29 1.27 1.27.0 00-.175.427 2.39 2.39.0 00-.054.514c0 .181.018.353.054.517s.095.307.175.43a.899.899.0 00.313.297c.127.073.281.11.462.11.18.0.334-.037.46-.11a.897.897.0 00.309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517.0-.18-.018-.352-.054-.514a1.271 1.271.0 00-.173-.426.901.901.0 00-.309-.291.917.917.0 00-.46-.108zm6.486.0a.925.925.0 00-.462.108.913.913.0 00-.313.29 1.27 1.27.0 00-.175.427 2.39 2.39.0 00-.053.514c0 .181.017.353.053.517s.095.307.175.43a.899.899.0 00.313.297c.127.073.281.11.462.11.18.0.334-.037.46-.11a.897.897.0 00.31-.296c.078-.124.136-.267.172-.431s.054-.336.054-.517c0-.18-.018-.352-.054-.514a1.271 1.271.0 00-.173-.426.901.901.0 00-.308-.291.916.916.0 00-.461-.108zm-8.537.068-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486.0-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08.0.143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541.0 010 .533c-.01.097-.028.187-.054.27a.584.584.0 01-.114.21.243.243.0 01-.193.085.248.248.0 01-.195-.086.584.584.0 01-.118-.209 1.245 1.245.0 01-.056-.27 2.645 2.645.0 010-.533c.01-.096.029-.186.056-.27a.583.583.0 01.118-.209.25.25.0 01.195-.084zm6.486.0c.08.0.144.028.193.084.05.057.087.127.114.21s.044.173.054.269a2.541 2.541.0 010 .533c-.01.097-.027.187-.054.27a.584.584.0 01-.114.21.243.243.0 01-.193.085.249.249.0 01-.195-.086.581.581.0 01-.117-.209 1.245 1.245.0 01-.056-.27 2.642 2.642.0 010-.533c.01-.096.028-.186.056-.27a.58.58.0 01.117-.209.25.25.0 01.195-.084zm-2.191 3.51a.93.93.0 00-.463.109.908.908.0 00-.312.291c-.08.122-.139.263-.175.426a2.383 2.383.0 00-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91.0 00.312.296.92.92.0 00.463.11c.18.0.333-.037.46-.11a.892.892.0 00.308-.296 1.32 1.32.0 00.174-.432c.036-.163.054-.335.054-.516.0-.18-.018-.352-.054-.514a1.274 1.274.0 00-.174-.426.89.89.0 00-.309-.291.918.918.0 00-.46-.108zm-6.402.07-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125.0-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116.0-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08.0.144.028.194.085a.605.605.0 01.114.21c.026.083.044.172.053.269a2.639 2.639.0 010 .532 1.28 1.28.0 01-.053.27.585.585.0 01-.114.21.244.244.0 01-.193.085.25.25.0 01-.196-.085.589.589.0 01-.117-.21 1.245 1.245.0 01-.056-.27 2.597 2.597.0 010-.532c.01-.097.028-.186.056-.27a.589.589.0 01.117-.209.249.249.0 01.196-.085zm-6.729 3.073a.676.676.0 00-.335.078.661.661.0 00-.227.211.91.91.0 00-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93.0 00.127.313.65.65.0 00.227.215c.092.053.204.08.335.08a.655.655.0 00.334-.08.65.65.0 00.225-.215c.057-.09.1-.194.125-.313a1.75 1.75.0 00.04-.375c0-.13-.014-.255-.04-.373a.931.931.0 00-.125-.31.658.658.0 00-.225-.21.667.667.0 00-.334-.08zm3.086.0a.675.675.0 00-.336.078.661.661.0 00-.226.211.907.907.0 00-.127.31 1.69 1.69.0 00-.04.373c0 .131.013.256.04.375a.928.928.0 00.127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655.0 00.334-.08.65.65.0 00.224-.215c.058-.09.1-.194.126-.313a1.752 1.752.0 000-.748.94.94.0 00-.126-.31.657.657.0 00-.224-.21.667.667.0 00-.334-.08zm5.108.0a.675.675.0 00-.336.078.661.661.0 00-.226.211.91.91.0 00-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931.0 00.127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13.0.243-.027.334-.08a.65.65.0 00.224-.215c.058-.09.1-.194.126-.313a1.75 1.75.0 00.04-.375c0-.13-.014-.255-.04-.373a.943.943.0 00-.126-.31.657.657.0 00-.224-.21.668.668.0 00-.334-.08zm-6.658.05-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068.0-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108.0-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058.0.105.02.14.062a.421.421.0 01.083.151.96.96.0 01.04.196 1.932 1.932.0 010 .386.954.954.0 01-.04.197.421.421.0 01-.083.152.176.176.0 01-.14.061.18.18.0 01-.141-.06.427.427.0 01-.085-.153.887.887.0 01-.041-.197 1.96 1.96.0 010-.386.893.893.0 01.04-.196.42.42.0 01.086-.151.181.181.0 01.141-.062zm3.086.0c.058.0.104.02.14.062a.421.421.0 01.082.151.94.94.0 01.04.196 1.906 1.906.0 010 .386.93.93.0 01-.04.197.421.421.0 01-.082.152.176.176.0 01-.14.061.18.18.0 01-.141-.06.42.42.0 01-.086-.153.846.846.0 01-.04-.197 1.965 1.965.0 01-.011-.195c0-.057.004-.121.01-.191a.849.849.0 01.041-.196.42.42.0 01.086-.151.182.182.0 01.141-.062zm5.108.0c.058.0.104.02.14.062a.421.421.0 01.082.151.92.92.0 01.04.196 1.963 1.963.0 010 .386.943.943.0 01-.04.197.421.421.0 01-.082.152.177.177.0 01-.14.061.18.18.0 01-.142-.06.437.437.0 01-.085-.153.95.95.0 01-.04-.197 1.965 1.965.0 01-.011-.195c0-.057.004-.121.01-.191a.959.959.0 01.04-.196.47.47.0 01.086-.151.181.181.0 01.142-.062zm-1.684 1.814a.675.675.0 00-.336.079.66.66.0 00-.227.21.91.91.0 00-.127.31 1.731 1.731.0 000 .748.939.939.0 00.127.314c.059.09.134.162.227.215s.205.08.336.08a.66.66.0 00.334-.08.648.648.0 00.224-.215c.058-.09.1-.195.126-.314a1.737 1.737.0 00-.001-.747.928.928.0 00-.125-.31.65.65.0 00-.224-.211.668.668.0 00-.334-.079zm3.063.0a.676.676.0 00-.336.079.664.664.0 00-.227.21.906.906.0 00-.127.31 1.74 1.74.0 000 .748.936.936.0 00.127.314.66.66.0 00.227.215c.092.053.204.08.336.08a.654.654.0 00.334-.08.648.648.0 00.223-.215c.058-.09.1-.195.126-.314a1.74 1.74.0 000-.747.928.928.0 00-.126-.31.65.65.0 00-.223-.211.666.666.0 00-.334-.079zm-1.545.05-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057.0.104.02.14.061a.42.42.0 01.082.152.91.91.0 01.04.195 1.966 1.966.0 010 .387.951.951.0 01-.04.197.421.421.0 01-.082.152.177.177.0 01-.14.06.18.18.0 01-.142-.06.428.428.0 01-.085-.152.914.914.0 01-.04-.197 1.96 1.96.0 01-.011-.195c0-.058.003-.122.01-.192a.923.923.0 01.041-.195c.02-.06.048-.11.085-.152a.181.181.0 01.142-.061zm3.063.0c.057.0.104.02.14.061a.42.42.0 01.082.152.94.94.0 01.04.195 1.91 1.91.0 010 .387.93.93.0 01-.04.197.422.422.0 01-.083.152.175.175.0 01-.14.06.18.18.0 01-.141-.06.423.423.0 01-.085-.152.907.907.0 01-.04-.197 1.95 1.95.0 010-.387.915.915.0 01.04-.195c.02-.06.048-.11.085-.152a.182.182.0 01.142-.061zm-9.713.185a.465.465.0 00-.232.055.456.456.0 00-.157.146.627.627.0 00-.089.215 1.168 1.168.0 00-.027.259c0 .09.009.177.027.26a.648.648.0 00.089.216c.04.063.093.112.157.149a.459.459.0 00.232.056c.09.0.168-.02.231-.056a.45.45.0 00.156-.149.67.67.0 00.087-.217 1.218 1.218.0 000-.518.647.647.0 00-.087-.215.448.448.0 00-.156-.146.458.458.0 00-.23-.055zm1.052.035-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04.0.073.014.097.042a.284.284.0 01.057.105.69.69.0 01.028.136c.004.049.007.092.007.133.0.04-.003.086-.007.135a.684.684.0 01-.028.136.285.285.0 01-.057.105.123.123.0 01-.097.043.125.125.0 01-.098-.043.298.298.0 01-.059-.105.612.612.0 01-.028-.136 1.39 1.39.0 010-.268.62.62.0 01.028-.136.297.297.0 01.06-.105.125.125.0 01.097-.042zm3.775 1.394a.463.463.0 00-.232.054.452.452.0 00-.157.146.621.621.0 00-.088.214 1.19 1.19.0 000 .519.641.641.0 00.088.217.46.46.0 00.157.15.458.458.0 00.232.054.454.454.0 00.232-.055.45.45.0 00.155-.149.664.664.0 00.087-.217 1.189 1.189.0 000-.519.642.642.0 00-.087-.214.446.446.0 00-.155-.146.459.459.0 00-.232-.054zm1.052.034-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04.0.073.014.098.043a.3.3.0 01.057.105.643.643.0 01.027.135 1.31 1.31.0 010 .268.654.654.0 01-.027.137.307.307.0 01-.057.105.124.124.0 01-.098.042.125.125.0 01-.098-.042.293.293.0 01-.059-.105.618.618.0 01-.028-.137 1.364 1.364.0 010-.268.612.612.0 01.028-.135.287.287.0 01.06-.105.123.123.0 01.097-.043z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://discordlookup.com/user/168778579281182721 target=_blank aria-label=Discordo rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><!doctype html><svg width="205" height="205" viewBox="-.72 -.72 25.44 25.44" id="meteor-icon-kit__regular-discord" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000" stroke-width=".00024000000000000003"><g id="SVGRepo_bgCarrier" stroke-width="0"/><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#ccc" stroke-width=".192"/><g id="SVGRepo_iconCarrier"><g clip-path="url(#clip0_525_68)"><path d="M20.317 4.54101c-1.5297-.71327-3.17-1.23877-4.8851-1.53975C15.4007 2.99545 15.3695 3.00997 15.3534 3.039 15.1424 3.4203 14.9087 3.91774 14.7451 4.30873c-1.8447-.28065-3.6799-.28065-5.48678.0C9.09465 3.90905 8.85248 3.4203 8.64057 3.039 8.62448 3.01094 8.59328 2.99642 8.56205 3.00126c-1.71414.30002-3.35449.82552-4.88512 1.53975C3.66368 4.54681 3.65233 4.5565 3.64479 4.56907.533392 9.29283-.31895 13.9005.0991801 18.451.101072 18.4733.11337 18.4946.130398 18.5081c2.052812 1.532 4.041312 2.462 5.992882 3.0785C6.15451 21.5963 6.18761 21.5847 6.20748 21.5585 6.66913 20.9179 7.08064 20.2424 7.43348 19.532 7.4543 19.4904 7.43442 19.441 7.39186 19.4246 6.73913 19.173 6.1176 18.8662 5.51973 18.5178 5.47244 18.4897 5.46865 18.421 5.51216 18.3881 5.63797 18.2923 5.76382 18.1926 5.88396 18.0919 5.90569 18.0736 5.93598 18.0697 5.96153 18.0813c3.92775 1.8223 8.17997 1.8223 12.06147.0C18.0485 18.0687 18.0788 18.0726 18.1015 18.091 18.2216 18.1916 18.3475 18.2923 18.4742 18.3881 18.5177 18.421 18.5149 18.4897 18.4676 18.5178 17.8697 18.8729 17.2482 19.173 16.5945 19.4236 16.552 19.4401 16.533 19.4904 16.5538 19.532 16.9143 20.2414 17.3258 20.9169 17.7789 21.5576 17.7978 21.5847 17.8319 21.5963 17.8631 21.5866 19.8241 20.9701 21.8126 20.0401 23.8654 18.5081 23.8834 18.4946 23.8948 18.4742 23.8967 18.452 24.3971 13.1911 23.0585 8.6212 20.3482 4.57004 20.3416 4.5565 20.3303 4.54681 20.317 4.54101zM8.02002 15.6802c-1.18252.0-2.15689-1.1032-2.15689-2.4582.0-1.3549.95547-2.4581 2.15689-2.4581 1.21085.0 2.17578 1.1129 2.15688 2.4581C10.1769 14.577 9.22141 15.6802 8.02002 15.6802zm7.97468.0c-1.1824.0-2.1568-1.1032-2.1568-2.4582.0-1.3549.955400000000001-2.4581 2.1568-2.4581 1.2109.0 2.1758 1.1129 2.1569 2.4581.0 1.355-.945999999999998 2.4582-2.1569 2.4582z" fill="silver"/></g><defs><clipPath id="clip0_525_68"><rect width="24" height="24" fill="#fff"/></clipPath></defs></g></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:jaybird1291.wcjg1@8alias.com target=_blank aria-label=Mail rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16.1875 4C8.8227525 3.8922232 2.9146119 10.485994 4.15625 18.03125c.8419086 5.120425 5.0487958 9.150129 10.1875 9.84375C17.808627 28.342845 21.04781 27.343076 23.5 25.375l-1.25-1.5625c-2.04581 1.641924-4.737127 2.487905-7.65625 2.09375-4.255296-.574379-7.7414086-3.953925-8.4375-8.1875C5.1078881 11.348006 9.9909975 5.9097768 16.15625 6 21.411045 6.077063 25.840449 10.43502 26 15.6875 26.0035 15.80006 26 15.909499 26 16.03125 25.992 18.234184 24.20805 20.000804 22 20 20.883008 19.999326 20 19.115742 20 18v-.5-3V10H18v.78125C17.281448 10.294583 16.427539 10 15.5 10c-2.473438.0-4.5 2.026562-4.5 4.5v3c0 2.473438 2.026562 4.5 4.5 4.5C16.847912 22 18.048165 21.385525 18.875 20.4375 19.60945 21.371627 20.728798 21.999233 22 22 25.28395 22.0012 27.988022 19.320316 28 16.03125 28 15.899001 28.0045 15.76844 28 15.625 27.807551 9.2894804 22.524705 4.0929369 16.1875 4zM15.5 12c1.392562.0 2.5 1.107438 2.5 2.5v3c0 1.392562-1.107438 2.5-2.5 2.5-1.392562.0-2.5-1.107438-2.5-2.5v-3c0-1.392562 1.107438-2.5 2.5-2.5z" style="fill:silver;stroke:silver;stroke-width:0"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://jaybird1291.github.io/japanese/ target=_blank aria-label=Cherry-Blossom rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><!doctype html><svg height="800" width="800" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"><style>.st0{fill:silver}</style><g><polygon class="st0" points="229.068,14.794 229.038,14.771 229.034,14.771 229.057,14.794"/><path class="st0" d="M510.206 220.622c-1.062-1.884-2.482-3.417-4.247-4.644v-.007l-.03-.023c-.419-.284-2.632-1.839-5.638-3.962-4.516-3.17-10.902-7.664-16.15-11.365-2.228-1.563-4.217-2.954-5.802-4.075.164-.456.314-.92.493-1.421 1.72-5.017 4.292-12.561 6.46-18.902 1.077-3.17 2.064-6.049 2.781-8.158.359-1.054.658-1.914.867-2.534.105-.299.194-.538.254-.71l.045-.157-.016.015c.016-.008.016-.023.016-.038v.007l.03-.06h-.015c.539-1.533.808-3.072.808-4.65.0-2.041-.433-4.194-1.495-6.281-1.046-2.079-2.782-4.052-4.905-5.383l.015.008c-.987-.613-1.884-1.1-2.901-1.616-1.899-.942-4.187-1.952-6.984-3.08-9.72-3.911-25.631-9.205-45.939-13.856-18.289-4.172-40.107-7.768-63.899-9.189-10.827-27.612-24.002-51.3-35.561-69.178-6.281-9.728-12.098-17.742-16.854-23.769-2.377-3.021-4.486-5.541-6.296-7.582-.912-1.032-1.75-1.922-2.556-2.729-.808-.816-1.54-1.525-2.438-2.266V15.01c-1.256-1.046-2.736-1.869-4.247-2.392-1.511-.531-3.066-.755-4.516-.755-3.246.022-6.056 1.047-8.48 2.886v-.008h-.014c-.105.09-.733.561-1.66 1.256-3.26 2.452-10.468 7.851-16.868 12.644-3.201 2.4-6.191 4.65-8.375 6.288-.044.022-.06.044-.09.067-.389-.292-.778-.584-1.211-.905-4.232-3.177-10.603-7.956-15.971-11.978-2.692-2.012-5.115-3.835-6.894-5.174-.897-.673-1.63-1.211-2.138-1.608-.27-.187-.464-.351-.613-.448l-.116-.09c-.012-.008-.023-.008-.034-.015l.011-.007-.011-.008-.03-.03-.016.007c-2.422-1.832-5.218-2.848-8.464-2.878-1.45-.008-2.991.224-4.516.755-1.514.516-3.014 1.36-4.277 2.422l.03-.022c-.03.014-.045.03-.06.044-.868.726-1.6 1.413-2.378 2.221-1.495 1.503-3.155 3.364-5.099 5.682-6.774 8.06-16.793 21.602-27.56 39.538-9.676 16.143-19.889 35.822-28.607 58.023-29.58 1.764-56.093 6.908-76.595 12.329-11.156 2.946-20.532 5.967-27.71 8.606-3.589 1.308-6.639 2.535-9.136 3.634-1.256.538-2.363 1.054-3.38 1.57-1.017.508-1.914.987-2.887 1.608-2.138 1.331-3.888 3.312-4.92 5.398-1.046 2.086-1.495 4.232-1.495 6.266.0 1.578.27 3.133.808 4.65l.016.053v.007c.03.068.074.224.164.472.823 2.377 3.858 11.282 6.685 19.574 1.42 4.15 2.782 8.143 3.798 11.104.09.27.179.508.254.74-.389.276-.792.56-1.241.868-4.322 3.058-10.842 7.641-16.315 11.492-2.752 1.937-5.234 3.679-7.058 4.965-.912.643-1.66 1.166-2.183 1.533-.269.187-.478.336-.628.433l-.135.098-.015.008-.044.037v.007c-1.765 1.234-3.186 2.767-4.247 4.644-1.062 1.899-1.78 4.21-1.78 6.774-.015 1.66.314 3.439.957 5.062.433 1.062.867 1.966 1.39 2.983.972 1.877 2.214 4.038 3.798 6.61 5.533 8.95 15.253 22.723 28.921 38.552 12.308 14.251 27.814 30.088 46.238 45.244-9.765 37.594-12.263 71.862-12.263 94.525.0 6.744.224 12.456.538 16.995.18 2.28.374 4.262.599 5.989.239 1.75.448 3.155.852 4.726l-.015-.008c.419 1.66 1.181 3.246 2.154 4.598 1.45 2.041 3.334 3.484 5.249 4.404 1.705.816 3.47 1.227 5.309 1.331v.015c.314.022.508.022.733.022h.12c.105.0.18.0.299.0.075.0.239-.008.493-.015 2.513-.037 11.919-.18 20.697-.314 4.366-.06 8.598-.127 11.724-.172.27.0.524-.015.778-.015.134.456.284.935.448 1.443 1.555 5.062 3.918 12.674 5.877 19.082.987 3.2 1.884 6.109 2.542 8.24.329 1.061.598 1.928.792 2.557.09.306.165.545.224.725l.06.194-.014-.06c.792 2.669 2.242 4.965 4.456 6.834 1.122.927 2.437 1.735 3.948 2.311 1.496.568 3.171.882 4.86.882.299.0.523-.014.673-.022l.194-.008c1.136-.074 2.123-.201 3.245-.381 2.079-.336 4.501-.844 7.432-1.555 10.184-2.468 26.214-7.402 45.445-15.456 17.318-7.275 37.131-17.115 57.26-29.96 24.988 15.955 49.543 27.276 69.357 34.813 10.797 4.098 20.188 7.088 27.561 9.122 3.693 1.01 6.878 1.78 9.541 2.348 1.33.284 2.526.508 3.648.688 1.106.18 2.109.307 3.23.381.404.03.703.03.882.03 1.675.0 3.365-.322 4.86-.89 2.258-.868 4.082-2.228 5.443-3.769 1.376-1.555 2.348-3.297 2.931-5.278l.015-.015v-.014l.015-.045c.164-.531.942-3.088 2.004-6.55 1.63-5.27 3.932-12.733 5.817-18.872.808-2.595 1.525-4.912 2.094-6.774.478.015.972.015 1.51.03 5.294.075 13.265.195 19.964.292 3.364.053 6.385.097 8.614.134 1.121.022 2.034.038 2.677.038.328.008.583.015.747.015l.18.008c.265.0.404.0.418.0 2.827-.015 5.488-.785 7.956-2.482 1.226-.845 2.393-1.952 3.35-3.298.957-1.345 1.72-2.931 2.138-4.583.389-1.57.598-2.976.838-4.718.328-2.587.613-5.772.822-9.608.194-3.843.329-8.33.329-13.377-.015-22.67-2.513-56.946-12.292-94.547 22.91-18.842 41.318-38.732 54.672-55.301 7.283-9.025 13.055-17.055 17.302-23.463 2.108-3.207 3.858-5.997 5.219-8.36.673-1.189 1.271-2.265 1.794-3.268.508-1.017.957-1.921 1.376-2.975.643-1.622.972-3.395.972-5.07C512 224.824 511.283 222.507 510.206 220.622zM458.569 265.35c-12.786 14.767-29.25 31.373-48.825 46.747-3.798 2.975-5.414 8-4.112 12.643 10.752 37.797 13.459 73.305 13.459 95.639.0 5.623-.18 10.348-.434 14.065-3.38-.045-7.357-.113-11.275-.18-9.167-.127-17.99-.262-17.99-.262-.03.0-.075.0-.09.0h-.18-.014-.016c-7.895.015-14.849 5.16-17.197 12.704v.008s-2.766 8.988-5.562 18.042c-1.077 3.484-2.138 6.961-3.066 9.967-2.408-.598-5.234-1.368-8.405-2.318-20.846-6.191-56.826-20.016-92.222-43.778-4.007-2.692-9.286-2.692-13.294.0-25.378 17.025-51.024 28.966-71.212 36.623-10.079 3.836-18.828 6.61-25.408 8.427-1.45.396-2.766.74-4.008 1.046-3.32-10.827-8.614-28.009-8.629-28.009-2.333-7.574-9.331-12.718-17.227-12.718l-.374.007h-.045c-1.181.023-9.914.15-18.722.277-3.634.06-7.268.12-10.408.165-.24-3.709-.404-8.487-.404-14.072-.015-22.334 2.692-57.843 13.444-95.639 1.316-4.652-.314-9.676-4.112-12.652-24.047-18.872-43.397-39.636-57.005-56.527-6.804-8.441-12.188-15.926-15.972-21.653-.838-1.271-1.585-2.43-2.258-3.5 2.782-1.958 6.026-4.246 9.241-6.512 7.507-5.279 14.715-10.356 14.715-10.356h.015c4.875-3.447 7.641-8.987 7.641-14.737.0-1.944-.314-3.918-.972-5.832.0.0-3.036-8.883-6.102-17.863-1.167-3.425-2.348-6.849-3.35-9.81 8.538-3.364 23.224-8.202 41.707-12.396 19.007-4.315 42.066-7.986 66.964-8.913 4.815-.179 9.092-3.282 10.752-7.814 10.543-28.72 24.226-53.61 36.024-71.84 5.877-9.114 11.306-16.569 15.553-21.967.927-1.167 1.78-2.228 2.587-3.193 2.706 2.034 5.862 4.404 9.002 6.767 7.343 5.495 14.401 10.789 14.401 10.789 3.185 2.386 7.029 3.604 10.812 3.59 3.783.014 7.626-1.204 10.812-3.59.0.0 7.507-5.638 15.104-11.335 2.901-2.168 5.802-4.344 8.3-6.221 5.876 7.111 15.103 19.628 24.884 36.017 10.034 16.771 20.711 37.602 29.28 60.982 1.66 4.539 5.922 7.642 10.752 7.821 30.581 1.144 58.411 6.416 79.316 11.949 10.453 2.751 19.171 5.57 25.586 7.933 1.376.5 2.617.972 3.754 1.428-1.077 3.193-2.363 6.946-3.634 10.655-2.931 8.599-5.758 16.861-5.802 17.011-.658 1.914-.972 3.896-.972 5.84.0 5.742 2.766 11.282 7.627 14.73h.03s7.672 5.413 15.432 10.872c2.976 2.101 5.952 4.187 8.524 5.996C480.073 238.223 471.086 250.919 458.569 265.35z"/><path class="st0" d="M324.281 254.471c-5.772.0-10.708 3.432-12.98 8.352h-40.9l28.921-28.921c5.07 1.876 10.992.814 15.089-3.268 5.593-5.6 5.593-14.662.0-20.255-5.608-5.593-14.67-5.6-20.263.0-4.082 4.082-5.144 10.004-3.274 15.089l-28.922 28.914v-40.9c4.936-2.258 8.375-7.208 8.375-12.973.0-7.918-6.415-14.326-14.326-14.326s-14.326 6.409-14.326 14.326c0 5.765 3.425 10.715 8.36 12.973v40.9l-28.921-28.914c1.869-5.085.807-11.006-3.275-15.089-5.592-5.6-14.67-5.6-20.248.0-5.608 5.593-5.608 14.655.0 20.255 4.082 4.082 9.989 5.144 15.073 3.268l28.922 28.921H200.7c-2.272-4.92-7.208-8.352-12.995-8.352-7.896.0-14.326 6.415-14.326 14.326.0 7.903 6.43 14.318 14.326 14.318 5.787.0 10.722-3.439 12.995-8.359h40.885l-28.922 28.922c-5.084-1.877-10.991-.808-15.089 3.267-5.592 5.601-5.592 14.662.0 20.255 5.593 5.593 14.671 5.593 20.263.0 4.082-4.075 5.144-10.004 3.275-15.089l28.921-28.921v40.906c-4.935 2.266-8.36 7.208-8.36 12.981.0 7.903 6.416 14.318 14.326 14.318 7.911.0 14.326-6.415 14.326-14.318.0-5.773-3.439-10.715-8.375-12.981V283.19l28.922 28.921c-1.87 5.085-.792 11.014 3.29 15.089 5.578 5.593 14.654 5.593 20.233.0 5.608-5.593 5.608-14.662.0-20.255-4.068-4.075-9.99-5.144-15.074-3.267L270.4 274.756h40.9c2.272 4.92 7.208 8.359 12.98 8.359 7.911.0 14.326-6.408 14.326-14.318C338.607 260.879 332.192 254.471 324.281 254.471z"/></g></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目次</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#シナリオ>シナリオ</a></li><li><a href=#セットアップ>セットアップ</a><ul><li><a href=#volatilityプロファイル>Volatilityプロファイル</a></li></ul></li><li><a href=#質問1>質問1</a></li><li><a href=#質問2>質問2</a></li><li><a href=#質問3>質問3</a></li><li><a href=#質問4>質問4</a></li><li><a href=#質問5>質問5</a></li><li><a href=#質問6>質問6</a></li><li><a href=#質問7>質問7</a></li><li><a href=#質問8>質問8</a></li><li><a href=#質問9>質問9</a></li><li><a href=#質問10>質問10</a></li><li><a href=#質問11>質問11</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目次</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#シナリオ>シナリオ</a></li><li><a href=#セットアップ>セットアップ</a><ul><li><a href=#volatilityプロファイル>Volatilityプロファイル</a></li></ul></li><li><a href=#質問1>質問1</a></li><li><a href=#質問2>質問2</a></li><li><a href=#質問3>質問3</a></li><li><a href=#質問4>質問4</a></li><li><a href=#質問5>質問5</a></li><li><a href=#質問6>質問6</a></li><li><a href=#質問7>質問7</a></li><li><a href=#質問8>質問8</a></li><li><a href=#質問9>質問9</a></li><li><a href=#質問10>質問10</a></li><li><a href=#質問11>質問11</a></li></ul></nav></div></details><script>var margin=200,marginError=50;(function(){var t=$(window),e=$("#TOCView"),s=e.height();function n(){var n=t.height()-margin;s>=n?(e.css("overflow-y","scroll"),e.css("max-height",n+marginError+"px")):(e.css("overflow-y","hidden"),e.css("max-height","9999999px"))}t.on("resize",n),$(document).ready(n)})(),function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=decodeURIComponent(t.attr("id")))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active").siblings("ul").hide()}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){e.find("a").parent("li").find("ul").hide(),n()})}}()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/lab_hubd7b99d2b11e0b38128a6c7939006bac_84996_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/lab_hubd7b99d2b11e0b38128a6c7939006bac_84996_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/lab_hubd7b99d2b11e0b38128a6c7939006bac_84996_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/lab_hubd7b99d2b11e0b38128a6c7939006bac_84996_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/lab_hubd7b99d2b11e0b38128a6c7939006bac_84996_660x0_resize_box_3.png alt></figure></p><h2 class="relative group">シナリオ<div id=%E3%82%B7%E3%83%8A%E3%83%AA%E3%82%AA class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E3%82%B7%E3%83%8A%E3%83%AA%E3%82%AA aria-label=アンカー>#</a></span></h2><blockquote><p>サーバー復旧後、IRチームは継続するトラフィック、隠された通信、および終了措置を回避する執拗なプロセスの迷宮を発見しました。ンシデントの範囲はサーバーとクライアントへの最初の侵害を超えていることが明らかです。フォレンジック調査の専門家として、これらの秘密裏の活動を隠す影を照らし出すことはできますか？</p></blockquote><h2 class="relative group">セットアップ<div id=%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97 aria-label=アンカー>#</a></span></h2><p>このSherlockチャレンジでは以下を使用します：</p><ul><li>Volatility2</li><li>IDA</li></ul><p>さらにこのチートシートを参照します：</p><ul><li><a href=https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet_v2.4.pdf target=_blank>https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet_v2.4.pdf</a></li></ul><h3 class="relative group">Volatilityプロファイル<div id=volatility%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#volatility%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB aria-label=アンカー>#</a></span></h3><p>まずPython 2とVolatility2をインストールし、必要なプロファイルを追加します。</p><p>Volatilityプロファイルは、ターゲットOSの構造情報を含むファイルです。特定のシステムのメモリ内でデータがどのように構成されているかをVolatilityが理解するための「地図」のようなものです。</p><p>このプロファイルは主に次の2種類の情報を含みます：</p><ul><li>カーネルデータ構造の定義</li><li>カーネルシンボル（関数や変数のアドレス）</li></ul><p>インストール：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install -y python2 python2-dev build-essential libdistorm3-dev libssl-dev libffi-dev zlib1g-dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -sS https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo python2 get-pip.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo python2 -m pip install --upgrade pip setuptools wheel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo python2 -m pip install distorm3 pycrypto openpyxl pillow yara-python
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git clone https://github.com/volatilityfoundation/volatility.git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> volatility
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 vol.py -h
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/vol2_hu413d987c7d5fabfadaa74f9e4e41ebcf_140088_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/vol2_hu413d987c7d5fabfadaa74f9e4e41ebcf_140088_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/vol2_hu413d987c7d5fabfadaa74f9e4e41ebcf_140088_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/vol2_hu413d987c7d5fabfadaa74f9e4e41ebcf_140088_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/vol2_hu413d987c7d5fabfadaa74f9e4e41ebcf_140088_660x0_resize_box_3.png alt></figure></p><p>プロファイル設定：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp Ubuntu_5.3.0-70-generic_profile.zip ~/Documents/volatility/volatility/plugins/overlays/linux/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python2 vol.py --info <span class=p>|</span> grep Linux
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/vol2profil_hu0b051a0280b29c1d7a474d3ed306e305_57137_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/vol2profil_hu0b051a0280b29c1d7a474d3ed306e305_57137_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/vol2profil_hu0b051a0280b29c1d7a474d3ed306e305_57137_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/vol2profil_hu0b051a0280b29c1d7a474d3ed306e305_57137_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/vol2profil_hu0b051a0280b29c1d7a474d3ed306e305_57137_660x0_resize_box_3.png alt></figure></p><h2 class="relative group">質問1<div id=%E8%B3%AA%E5%95%8F1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F1 aria-label=アンカー>#</a></span></h2><blockquote><p>攻撃者がリバースシェルに使用したIPとポートは何ですか？</p></blockquote><p>メモリキャプチャ時点のすべてのネットワーク接続をダンプするために<strong>linux_netstat</strong>プラグインを使用します。出力をファイルにリダイレクトし、検索を容易にします。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_netstat &gt; netstat.txt
</span></span></code></pre></div><p>Linuxでは、乱雑なBashリバースシェルである可能性が高く、実際に：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/netstat_hu23ecfd2d735878b0d2a27716bcf4e302_73640_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/netstat_hu23ecfd2d735878b0d2a27716bcf4e302_73640_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/netstat_hu23ecfd2d735878b0d2a27716bcf4e302_73640_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/netstat_hu23ecfd2d735878b0d2a27716bcf4e302_73640_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/netstat_hu23ecfd2d735878b0d2a27716bcf4e302_73640_660x0_resize_box_3.png alt=netstat></figure></p><p><strong>回答</strong>：<code>10.0.2.6:443</code></p><h2 class="relative group">質問2<div id=%E8%B3%AA%E5%95%8F2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F2 aria-label=アンカー>#</a></span></h2><blockquote><p>悪意あるリバースシェル接続のPPIDは何ですか？</p></blockquote><p>まずは <code>linux_pstree</code> を試してみます：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_pstree <span class=p>|</span> grep -C <span class=m>5</span> <span class=m>3633</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/pstree_huc01577dfefdef41ee7be7db3e3173efc_146667_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/pstree_huc01577dfefdef41ee7be7db3e3173efc_146667_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/pstree_huc01577dfefdef41ee7be7db3e3173efc_146667_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/pstree_huc01577dfefdef41ee7be7db3e3173efc_146667_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/pstree_huc01577dfefdef41ee7be7db3e3173efc_146667_660x0_resize_box_3.png alt=pstree></figure></p><p>PPIDがありません。なぜでしょう？<br><code>linux_pstree</code> プラグインは、単一の情報源――システムのアクティブタスクリスト（<code>task_struct</code>）――に基づいてプロセスツリーを再構築します。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/kernel-map_hudab2ee8053072e42bda9f53cd89fe2e3_719129_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/kernel-map_hudab2ee8053072e42bda9f53cd89fe2e3_719129_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/kernel-map_hudab2ee8053072e42bda9f53cd89fe2e3_719129_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/kernel-map_hudab2ee8053072e42bda9f53cd89fe2e3_719129_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/kernel-map_hudab2ee8053072e42bda9f53cd89fe2e3_719129_660x0_resize_box_3.png alt="kernel map"></figure><br><a href=https://makelinux.github.io/kernel/map/ target=_blank>https://makelinux.github.io/kernel/map/</a></p><p>そこで、隠れプロセス検出に特化した <code>linux_psxview</code> プラグインを使用します。複数のアーティファクトを集約してプロセスを識別します：</p><ul><li><strong>task_struct リスト</strong>: <code>linux_pstree</code> と同じアクティブタスクリスト</li><li><strong>pid ハッシュテーブル</strong>: カーネルのPID高速検索用ハッシュテーブル</li><li><strong>pslist</strong>: 別のメモリ構造から抽出したプロセスリスト</li><li><strong>kmem_cache</strong>: 隠れタスクを参照している可能性があるカーネルオブジェクトキャッシュ</li><li><strong>d_path</strong>: procfsからのファイルシステムパスでプロセスディレクトリを露出検出</li><li><strong>thread_info</strong>: 非リンクプロセスを浮かび上がらせるスレッドメタデータ</li></ul><p><code>linux_psxview</code> はこれらの情報源を相互比較し、不整合を検出します。例えば、あるソースには存在するが別のソースにはないPIDなどです。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_psxview &gt; psxview.txt
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/psxview_hu6a63bd65111422d958b16cdd3c8e3431_42611_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/psxview_hu6a63bd65111422d958b16cdd3c8e3431_42611_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/psxview_hu6a63bd65111422d958b16cdd3c8e3431_42611_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/psxview_hu6a63bd65111422d958b16cdd3c8e3431_42611_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/psxview_hu6a63bd65111422d958b16cdd3c8e3431_42611_660x0_resize_box_3.png alt=psxview></figure></p><p>期待どおり、親プロセスは直前のPIDです。</p><p>では、なぜ隠されていたのでしょうか？
シナリオの内容から、ルートキットによる操作であることが明らかです。おそらく、ルートキットはタスクリスト（<em>task_struct リスト</em>）を改ざんし、自身のリバースシェルプロセスをリンクリストから“unlink”しました。具体的には、<code>next</code> と <code>prev</code> ポインタを操作し、リスト走査時にプロセスが無視されるようにしています。</p><p>しかし、ルートキットは存在の痕跡を完全には消し切れていません。他の構造体のうち複数のいずれかを <code>linux_psxview</code> が監視する中で、変更を怠っている箇所が残っていました。</p><p>結果として、<code>linux_pstree</code> はタスクリストだけを参照するため悪意あるプロセスを見逃しますが、<code>linux_psxview</code> は複数の情報源をチェックすることで、ルートキットが見落とした構造体経由で検出できる、というわけです。</p><p><strong>回答</strong> : <code>3632</code></p><h2 class="relative group">質問3<div id=%E8%B3%AA%E5%95%8F3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F3 aria-label=アンカー>#</a></span></h2><blockquote><p>悪意あるカーネルモジュールの名前を答えよ。</p></blockquote><p>このために <code>linux_check_modules</code> プラグインを使用します。ただ、その前にコンテキストを整理しましょう。そもそもカーネルモジュールとは何か、またそれはルートキットとどのように関係するのでしょうか？</p><p>カーネルモジュールとは、実行中のOSカーネルに動的にロード／アンロードできるコードの断片です。これにより、再起動やカーネルの再コンパイルなしで新しいハードウェアサポートやファイルシステム機能を追加できます。</p><p>ルートキットは独自のLoadable Kernel Modules（LKM）を使ってLinuxカーネルレベルで動作します。これらの悪意あるモジュールは：</p><ul><li>システムコールをフックしてファイル、プロセス、ネットワーク接続を隠蔽</li><li>システムに永続的なバックドアを確立</li><li>カーネルのセキュリティ機能を無効化</li><li>標準ツールから自身の存在を隠蔽<br>…などを行います。</li></ul><p>Volatilityの <code>linux_check_modules</code> プラグインは、複数のカーネル情報ソースを突き合わせることで隠れたLKMを検出します。</p><p><strong>1. 公式モジュールリスト</strong><br>まず、カーネルが管理する公式モジュールリスト（<code>modules.list</code>）を調査します。この循環連結リストには正規にロードされたすべてのモジュールが含まれ、<code>lsmod</code> コマンドで同じ情報が得られます。</p><p><strong>2. カーネルシンボルテーブル</strong><br>次に、<code>/proc/kallsyms</code> を解析し、モジュールが追加したものも含めたすべての関数・変数のアドレスを取得します。</p><p><strong>3. <code>.ko</code> メモリセクション</strong><br>さらに、<code>.ko</code> モジュールがロードされる典型的なメモリ領域をスキャンし、他の場所で参照されていなくてもモジュールコードの特徴的なシグネチャを探索します。</p><p><strong>4. 隠しモジュール検出テクニック</strong></p><ul><li>公式リストとシンボル／メモリスキャン結果を比較し、一方に存在して他方にないモジュールを疑います。</li><li>syscallテーブルをチェックし、オリジナルのカーネル関数がフックまたは置換されていないかを確認します。</li><li>モジュール関数のアドレスが通常とは異なるメモリ領域を指していないか検証し、コードインジェクションの可能性を探ります。</li><li>モジュールのメタデータ（タイムスタンプ、名前、作者など）に矛盾や異常がないか分析します。</li></ul><blockquote><p><strong>なるほど、でもルートキットはどのように隠れるの？</strong></p></blockquote><p>主な手法には以下があります：</p><ul><li><strong>DKOM (Direct Kernel Object Manipulation)</strong><br>メモリ上のカーネルデータ構造を直接操作し、<code>modules.list</code> から自モジュールをunlinkしつつ機能を維持。</li><li><strong>システムコールフック</strong><br>正規のカーネル関数を置き換え、自作のバージョンで結果をフィルタリングまたは偽装（例：特定ファイルを表示しないreadのパッチ）。</li><li><strong>無名モジュール</strong><br>空文字列や特殊文字名でモジュールをロードし、発見を困難にします。</li></ul><p>さて、本題に戻ります。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_check_modules 
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/modules_hu6291749db39fc87dd757e38c4dbe1316_50937_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/modules_hu6291749db39fc87dd757e38c4dbe1316_50937_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/modules_hu6291749db39fc87dd757e38c4dbe1316_50937_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/modules_hu6291749db39fc87dd757e38c4dbe1316_50937_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/modules_hu6291749db39fc87dd757e38c4dbe1316_50937_660x0_resize_box_3.png alt=linux_check_modules></figure></p><p>モジュール名 <strong>&ldquo;nfentlink&rdquo;</strong> は、正規の <strong>&ldquo;nfnetlink&rdquo;</strong> モジュールを装うことで悪意あるLKMをカモフラージュしようとしたものです。<code>nfnetlink</code> はネットワークおよびファイアウォール機能のためにカーネル空間とユーザー空間間の通信を行う正規モジュールです。</p><p><strong>回答</strong>: <code>nfentlink</code></p><h2 class="relative group">質問4<div id=%E8%B3%AA%E5%95%8F4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F4 aria-label=アンカー>#</a></span></h2><blockquote><p>モジュールがロードされたのは何時ですか？</p></blockquote><p>当初、私が試したアプローチには誤りがありました。その思考過程を示します：</p><ul><li><code>linux_dmesg</code> で <code>dmesg</code> からモジュールのロードタイムスタンプを取得</li><li><code>linux_pslist</code> でシステム起動のタイムスタンプを取得</li><li>それらの差分を計算</li></ul><p>もしモジュールが初回ロードであればこの方法で問題ありませんでした。しかし、既に過去にロードされていたため、この方法は根本的に誤っており、インシデントレスポンスの現場では誤誘導を招きかねません。</p><p>最終的に私は考えをリセットし、「複数回の再起動にまたがる過去のアクションに紐づくタイムスタンプはどこにあるか？」と自問しました。</p><p>もちろん、システムログです。特に <code>/var/log/kern.log</code> や <code>/var/log/syslog.log</code> が該当します。</p><p>これらのファイルを抽出するため、まずメモリキャプチャ内でファイルを列挙します：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_enumerate_files &gt; files.txt
</span></span></code></pre></div><p>実際には次のように見つかりました：<br><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/enumerate_hu0e883be9e7acf012f3448081998dace1_214239_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/enumerate_hu0e883be9e7acf012f3448081998dace1_214239_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/enumerate_hu0e883be9e7acf012f3448081998dace1_214239_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/enumerate_hu0e883be9e7acf012f3448081998dace1_214239_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/enumerate_hu0e883be9e7acf012f3448081998dace1_214239_660x0_resize_box_3.png alt=enumerate></figure></p><p>次に <code>/var/log/kern.log</code> を抽出します：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_find_file -i 0xffff98ea5a732fa8 -O kern.log
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/kernel.log_hu1eb4ef1f384dd42f6e648dffb6fb7acf_213486_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/kernel.log_hu1eb4ef1f384dd42f6e648dffb6fb7acf_213486_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/kernel.log_hu1eb4ef1f384dd42f6e648dffb6fb7acf_213486_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/kernel.log_hu1eb4ef1f384dd42f6e648dffb6fb7acf_213486_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/kernel.log_hu1eb4ef1f384dd42f6e648dffb6fb7acf_213486_660x0_resize_box_3.png alt=kernel.log></figure></p><p><strong>回答</strong>：<code>2024-05-01 20:42:57</code></p><h2 class="relative group">質問5<div id=%E8%B3%AA%E5%95%8F5 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F5 aria-label=アンカー>#</a></span></h2><blockquote><p>悪意あるカーネルモジュールファイルのフルパスと名前は何ですか？</p></blockquote><p>同様に、列挙したファイルを確認します。まず、特定したモジュール “nfentlink” を検索します。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat files.txt <span class=p>|</span>grep nfentlink
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/files_hu38c8b139cdec9fc63eff1351f911d5da_34527_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/files_hu38c8b139cdec9fc63eff1351f911d5da_34527_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/files_hu38c8b139cdec9fc63eff1351f911d5da_34527_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/files_hu38c8b139cdec9fc63eff1351f911d5da_34527_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/files_hu38c8b139cdec9fc63eff1351f911d5da_34527_660x0_resize_box_3.png alt></figure></p><p>特に有益な情報は見つかりませんでした。</p><p>そこで、実際の名前でモジュールを探します：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/files2_hucf36f5b39361025493449a0999d83d30_53332_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/files2_hucf36f5b39361025493449a0999d83d30_53332_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/files2_hucf36f5b39361025493449a0999d83d30_53332_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/files2_hucf36f5b39361025493449a0999d83d30_53332_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/files2_hucf36f5b39361025493449a0999d83d30_53332_660x0_resize_box_3.png alt></figure></p><p>2つ目のファイルについては後ほど戻ります。</p><p><strong>回答</strong>：<code>/lib/modules/5.3.0-70-generic/kernel/drivers/net/nfnetlink.ko</code></p><h2 class="relative group">質問6<div id=%E8%B3%AA%E5%95%8F6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F6 aria-label=アンカー>#</a></span></h2><blockquote><p>悪意あるカーネルモジュールファイルのMD5ハッシュは何ですか？</p></blockquote><p>ファイルを抽出してハッシュを計算します：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 vol.py -f ~/Downloads/APTNightmare-2/dump.mem --profile<span class=o>=</span>LinuxUbuntu_5_3_0-70-generic_profilex64 linux_find_file -i 0xffff98ea266b5a68 -O nfnetlink.ko
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>md5sum nfnetlink.ko
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/hash_hu1e03ec9a7ee20813acf90f55c38868dd_119872_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/hash_hu1e03ec9a7ee20813acf90f55c38868dd_119872_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/hash_hu1e03ec9a7ee20813acf90f55c38868dd_119872_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/hash_hu1e03ec9a7ee20813acf90f55c38868dd_119872_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/hash_hu1e03ec9a7ee20813acf90f55c38868dd_119872_660x0_resize_box_3.png alt></figure></p><p><strong>回答</strong>：<code>35bd8e64b021b862a0e650b13e0a57f7</code></p><h2 class="relative group">質問7<div id=%E8%B3%AA%E5%95%8F7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F7 aria-label=アンカー>#</a></span></h2><blockquote><p>正規のカーネルモジュールファイルのフルパスと名前は何ですか？</p></blockquote><p>質問5のスクリーンショットに戻りましょう。</p><p><strong>回答</strong>：<code>/lib/modules/5.3.0-70-generic/kernel/net/netfilter/nfnetlink.ko</code></p><h2 class="relative group">質問8<div id=%E8%B3%AA%E5%95%8F8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F8 aria-label=アンカー>#</a></span></h2><blockquote><p>正規モジュールと悪意あるモジュールの author 値の一文字の違いは何ですか？</p></blockquote><p>まず、特定のカーネルモジュールに関する詳細情報を表示する <strong>modinfo</strong> で正規モジュールを確認します。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>modinfo /lib/modules/6.11.2-amd64/kernel/net/netfilter/nfnetlink.ko.xz
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/modinfo1_hudc792a95a623c62e143147eb9e044a20_127883_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/modinfo1_hudc792a95a623c62e143147eb9e044a20_127883_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/modinfo1_hudc792a95a623c62e143147eb9e044a20_127883_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/modinfo1_hudc792a95a623c62e143147eb9e044a20_127883_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/modinfo1_hudc792a95a623c62e143147eb9e044a20_127883_660x0_resize_box_3.png alt></figure></p><p>次に、メモリキャプチャから抽出したモジュールを調査します。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>modinfo malicious-nfnetlink.ko
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/modinfo2_hu36178caacfe313e2b94d83e5fdb61b15_82309_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/modinfo2_hu36178caacfe313e2b94d83e5fdb61b15_82309_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/modinfo2_hu36178caacfe313e2b94d83e5fdb61b15_82309_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/modinfo2_hu36178caacfe313e2b94d83e5fdb61b15_82309_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/modinfo2_hu36178caacfe313e2b94d83e5fdb61b15_82309_660x0_resize_box_3.png alt></figure></p><p>はっきりと “i” が欠落しているのが分かります。</p><p><strong>回答</strong>：<code>i</code></p><h2 class="relative group">質問9<div id=%E8%B3%AA%E5%95%8F9 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F9 aria-label=アンカー>#</a></span></h2><blockquote><p>悪意あるカーネルモジュールの初期化関数の名前は何ですか？</p></blockquote><p>この質問に答えるために<strong>IDA</strong>を使います。オーバーキルかもしれませんが、gdb（gef>gdb）やradare2などでも十分です。</p><p>では、関数を見てみましょう：<br><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/functions_hu7ad814e2f52238b6f8ce7574099f8e09_39649_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/functions_hu7ad814e2f52238b6f8ce7574099f8e09_39649_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/functions_hu7ad814e2f52238b6f8ce7574099f8e09_39649_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/functions_hu7ad814e2f52238b6f8ce7574099f8e09_39649_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/functions_hu7ad814e2f52238b6f8ce7574099f8e09_39649_660x0_resize_box_3.png alt></figure></p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/nfnetlink_init_hu26cf55a3248e0b7caf110094d763e0eb_24441_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/nfnetlink_init_hu26cf55a3248e0b7caf110094d763e0eb_24441_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/nfnetlink_init_hu26cf55a3248e0b7caf110094d763e0eb_24441_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/nfnetlink_init_hu26cf55a3248e0b7caf110094d763e0eb_24441_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/nfnetlink_init_hu26cf55a3248e0b7caf110094d763e0eb_24441_660x0_resize_box_3.png alt></figure></p><p>初期化関数が <code>nfnetlink_init</code> であると同時に <code>init_module</code> でもあることがはっきり分かります。gefで見るとさらに明確です：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/gef_hu3d22953f39ed04eb0ed911e05ca9c8f9_117537_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/gef_hu3d22953f39ed04eb0ed911e05ca9c8f9_117537_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/gef_hu3d22953f39ed04eb0ed911e05ca9c8f9_117537_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/gef_hu3d22953f39ed04eb0ed911e05ca9c8f9_117537_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/gef_hu3d22953f39ed04eb0ed911e05ca9c8f9_117537_660x0_resize_box_3.png alt></figure></p><p>gef は両方のシンボルがまったく同じメモリアドレスを指していることを示しています。これは、ルートキットがカーネルレベルで自身を偽装するための意図的な手法です。</p><p>悪意あるモジュールは、Linux カーネルモジュールの <strong>必須</strong> エントリポイントである標準の <code>init_module</code> 関数を利用しつつ、正規モジュールを模倣するために意図的に関数名を <code>nfnetlink_init</code> に変更しています。</p><p><code>init_module</code> のようなエクスポートシンボルはカーネルがモジュールをロードするのに不可欠ですが、攻撃者はコンパイル時のトリックを使い、同一関数に二つの異なる名前（ロード用とカモフラージュ用）を持たせています。</p><p><strong>回答</strong>: <code>nfnetlink_init</code></p><h2 class="relative group">質問10<div id=%E8%B3%AA%E5%95%8F10 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F10 aria-label=アンカー>#</a></span></h2><blockquote><p>システムコールをフックする関数があります。テーブルの最後のシステムコールは何ですか？</p></blockquote><p><code>nfnetlink_init</code> 関数内で <code>_sys_call_table = kallsyms_lookup_name("sys_call_table");</code> が確認できます:</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/syscalltable_hu2d5d9c9c5912ea429c1cfc031159e995_32358_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/syscalltable_hu2d5d9c9c5912ea429c1cfc031159e995_32358_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/syscalltable_hu2d5d9c9c5912ea429c1cfc031159e995_32358_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/syscalltable_hu2d5d9c9c5912ea429c1cfc031159e995_32358_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/syscalltable_hu2d5d9c9c5912ea429c1cfc031159e995_32358_660x0_resize_box_3.png alt></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>_sys_call_table</span> <span class=err>=</span> <span class=nv>kallsyms_lookup_name</span><span class=p>(</span><span class=s>&#34;sys_call_table&#34;</span><span class=p>)</span><span class=c1>;</span>
</span></span></code></pre></div><p>この行は <code>kallsyms_lookup_name</code> を使用して、カーネルメモリ上の <code>sys_call_table</code> のアドレスを取得しています。</p><p><code>sys_call_table</code> はカーネルのシステムコールハンドラ関数へのポインタを格納した配列です。このテーブルを書き換えることで、攻撃者はシステムコールをマルウェアルーチンへリダイレクトできます。</p><p>次に、<code>.rodata</code> セクション（読み取り専用データおよび文字列が配置される領域）のデータテーブルを調査します。</p><p>このテーブルには、悪意あるモジュールが各種操作のために使用またはフックしようとするシンボルへの参照が含まれています。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>aX64SysGetdents</span>       <span class=nv>db</span> <span class=s>&#39;_x64_sys_getdents64&#39;</span><span class=p>,</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=nf>aX64SysGetdents</span>       <span class=nv>db</span> <span class=s>&#39;_x64_sys_getdents&#39;</span><span class=p>,</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=nf>aX64SysKill</span>           <span class=nv>db</span> <span class=s>&#39;_x64_sys_kill&#39;</span><span class=p>,</span><span class=mi>0</span>
</span></span></code></pre></div><p>これらの文字列は、モジュールがフックまたはオーバーライドしようとしているシステムコール関数シンボルに対応しています。</p><p>これらの関数は Linux カーネルのシステムコール API の一部であり、この場合はインターセプトまたはリダイレクトされています。</p><p><strong>回答</strong>: <code>__x64_sys_kill</code></p><h2 class="relative group">質問11<div id=%E8%B3%AA%E5%95%8F11 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E8%B3%AA%E5%95%8F11 aria-label=アンカー>#</a></span></h2><blockquote><p>実行中のプロセスID (PID) を隠すために、プロセスに送信する際に使用されるシグナル番号は何ですか？</p></blockquote><p>では、<code>hook_kill</code> 関数を見てみましょう:</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/hook_kill_hua65e85c74d6db38034d221ab04faa582_34148_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/hook_kill_hua65e85c74d6db38034d221ab04faa582_34148_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/hook_kill_hua65e85c74d6db38034d221ab04faa582_34148_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/hook_kill_hua65e85c74d6db38034d221ab04faa582_34148_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/hook_kill_hua65e85c74d6db38034d221ab04faa582_34148_660x0_resize_box_3.png alt=hook_kill></figure></p><p>まず目を引くのは:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span>     <span class=kt>dword</span> <span class=nv>ptr</span> <span class=p>[</span><span class=nb>rdi</span><span class=o>+</span><span class=mh>68h</span><span class=p>],</span> <span class=mi>64</span>
</span></span></code></pre></div><p>および <code>hide_pid</code> の呼び出しです。</p><p>続いて、IDAで生成された擬似コードを見てみます:</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/code_hook_kill_hu951cc42a1dc3ea506e07ea9d38be2a55_9583_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/code_hook_kill_hu951cc42a1dc3ea506e07ea9d38be2a55_9583_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/code_hook_kill_hu951cc42a1dc3ea506e07ea9d38be2a55_9583_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/code_hook_kill_hu951cc42a1dc3ea506e07ea9d38be2a55_9583_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/code_hook_kill_hu951cc42a1dc3ea506e07ea9d38be2a55_9583_660x0_resize_box_3.png alt=hook_kill></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>DWORD</span> <span class=o>*</span><span class=p>)(</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>104</span><span class=p>))</span> <span class=o>!=</span> <span class=mi>64</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>((</span><span class=kr>__int64</span> <span class=p>(</span><span class=o>*</span><span class=p>)</span> <span class=p>(</span><span class=kt>void</span><span class=p>))</span><span class=nf>orig_kill</span><span class=p>());</span>
</span></span></code></pre></div><ul><li><code>a1 + 104</code>: これは <code>kill()</code> 呼び出しで送信されたシグナルを参照します。アドレス <code>a1 + 104</code> のフィールドがシグナルの値に対応します。</li><li><code>(*(DWORD *)(a1 + 104)) != 64</code>: この条件はシグナルが 64 でないかをチェックしています。<ul><li>シグナルが 64 でない場合、元のシステムコール <code>orig_kill</code> を呼び出して通常通りカーネル実行を継続します。</li><li>シグナルが 64 の場合は <code>hide_pid</code> を呼び出します:</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=nf>sprintf</span><span class=p>(</span><span class=n>hide_pid</span><span class=p>,</span> <span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>*</span><span class=p>((</span><span class=n>QWORD</span> <span class=o>*</span><span class=p>)(</span><span class=n>a1</span> <span class=o>+</span> <span class=mi>112</span><span class=p>)));</span>
</span></span></code></pre></div><ul><li><code>sprintf(hide_pid, "%d", ...)</code>: ここで <code>sprintf</code> を使用して PID を文字列に変換し、<code>hide_pid</code> に渡しています。これは、モジュールがこのPIDを元に、<code>/proc</code> やシステムディレクトリ、その他のカーネルデータ構造からプロセスを隠蔽していることを示しています。</li><li><code>hide_pid</code>: プロセスを隠蔽し、可視性を阻止する関数です。</li><li><code>%d</code>: 整数（PID）を出力するためのフォーマット指定子です。</li></ul><p><strong>回答</strong>: <code>64</code></p><hr><p>ラボ完了！</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/cyber/posts/aptnightmare2/pictures/finished_huc7f74929555354863d1ec31b3b759ab4_147339_330x0_resize_box_3.png 330w,
/cyber/posts/aptnightmare2/pictures/finished_huc7f74929555354863d1ec31b3b759ab4_147339_660x0_resize_box_3.png 660w,
/cyber/posts/aptnightmare2/pictures/finished_huc7f74929555354863d1ec31b3b759ab4_147339_1024x0_resize_box_3.png 1024w,
/cyber/posts/aptnightmare2/pictures/finished_huc7f74929555354863d1ec31b3b759ab4_147339_1320x0_resize_box_3.png 2x" src=/cyber/posts/aptnightmare2/pictures/finished_huc7f74929555354863d1ec31b3b759ab4_147339_660x0_resize_box_3.png alt></figure></p></div></div><script>var oid="views_posts/aptnightmare-2/index.md",oid_likes="likes_posts/aptnightmare-2/index.md"</script><script type=text/javascript src=/cyber/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/cyber/ja/posts/latus/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Latus</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-03-10T00:00:05+00:00>10 3月 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/cyber/ja/posts/streamer/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Streamer</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-06-01T00:00:05+00:00>1 6月 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=TOPへスクロール title=TOPへスクロール>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/cyber/ja/tags/ title>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Jaybird1291</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/cyber/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://jaybird1291.github.io/cyber/ja/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=検索 tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="閉じる (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>